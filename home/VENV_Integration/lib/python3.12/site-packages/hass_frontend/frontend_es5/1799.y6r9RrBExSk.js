"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[1799],{46999:function(t,e,n){n.d(e,{Vy:function(){return s},fI:function(){return r}});var a=n(3254),i=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function s(t){return i[t%i.length]}function r(t,e){var n=e.getPropertyValue("--graph-color-".concat(t+1))||s(t);return(0,a.RQ)(n)}},96979:function(t,e,n){n.d(e,{I:function(){return o}});var a=n(71008),i=n(35806),s=(n(39805),n(89655),n(97099),n(72735),n(26098),n(10507),n(39790),n(253),n(54846),n(78266),n(66555),function(){return(0,i.A)((function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.localStorage;(0,a.A)(this,t),this.storage=void 0,this._storage={},this._listeners={},this.storage=n,n===window.localStorage&&window.addEventListener("storage",(function(t){t.key&&e.hasKey(t.key)&&(e._storage[t.key]=t.newValue?JSON.parse(t.newValue):t.newValue,e._listeners[t.key]&&e._listeners[t.key].forEach((function(n){return n(t.oldValue?JSON.parse(t.oldValue):t.oldValue,e._storage[t.key])})))}))}),[{key:"addFromStorage",value:function(t){if(!this._storage[t]){var e=this.storage.getItem(t);e&&(this._storage[t]=JSON.parse(e))}}},{key:"subscribeChanges",value:function(t,e){var n=this;return this._listeners[t]?this._listeners[t].push(e):this._listeners[t]=[e],function(){n.unsubscribeChanges(t,e)}}},{key:"unsubscribeChanges",value:function(t,e){if(t in this._listeners){var n=this._listeners[t].indexOf(e);-1!==n&&this._listeners[t].splice(n,1)}}},{key:"hasKey",value:function(t){return t in this._storage}},{key:"getValue",value:function(t){return this._storage[t]}},{key:"setValue",value:function(t,e){var n=this._storage[t];this._storage[t]=e;try{void 0===e?this.storage.removeItem(t):this.storage.setItem(t,JSON.stringify(e))}catch(a){}finally{this._listeners[t]&&this._listeners[t].forEach((function(t){return t(n,e)}))}}}])}()),r={},o=function(t){return function(e){var n,a=t.storage||"localStorage";a&&a in r?n=r[a]:(n=new s(window[a]),r[a]=n);var i=String(e.key),o=t.key||String(e.key),c=e.initializer?e.initializer():void 0;n.addFromStorage(o);var d=!1!==t.subscribe?function(t){return n.subscribeChanges(o,(function(n,a){t.requestUpdate(e.key,n)}))}:void 0,u=function(){return n.hasKey(o)?t.deserializer?t.deserializer(n.getValue(o)):n.getValue(o):c};return{kind:"method",placement:"prototype",key:e.key,descriptor:{set:function(a){!function(a,i){var s;t.state&&(s=u()),n.setValue(o,t.serializer?t.serializer(i):i),t.state&&a.requestUpdate(e.key,s)}(this,a)},get:function(){return u()},enumerable:!0,configurable:!0},finisher:function(n){if(t.state&&t.subscribe){var a=n.prototype.connectedCallback,s=n.prototype.disconnectedCallback;n.prototype.connectedCallback=function(){a.call(this),this["__unbsubLocalStorage".concat(i)]=null==d?void 0:d(this)},n.prototype.disconnectedCallback=function(){var t;s.call(this),null===(t=this["__unbsubLocalStorage".concat(i)])||void 0===t||t.call(this),this["__unbsubLocalStorage".concat(i)]=void 0}}t.state&&n.createProperty(e.key,Object.assign({noAccessor:!0},t.stateOptions))}}}}},56136:function(t,e,n){n.d(e,{a:function(){return a}});var a=function(t){return!(t.native instanceof MouseEvent)||t.native instanceof PointerEvent&&"mouse"!==t.native.pointerType}},20712:function(t,e,n){n.d(e,{E:function(){return l}});var a=n(64782),i=n(35806),s=n(71008),r=n(62193),o=n(2816),c=n(27927),d=n(35890),u=(n(81027),n(82386),n(95737),n(39790),n(66457),n(36604),n(253),n(4525),n(96858),n(29818)),l=function(t){var e=(0,c.A)(null,(function(t,e){var n=function(e){function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=(0,r.A)(this,n,[].concat(i)),t(e),e}return(0,o.A)(n,e),(0,i.A)(n)}(e);return{F:n,d:[{kind:"field",decorators:[(0,u.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,d.A)(n,"connectedCallback",this,3)([]),this.__checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,d.A)(n,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){var t=this.__unsubs.pop();t instanceof Promise?t.then((function(t){return t()})):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,d.A)(n,"updated",this,3)([t]),t.has("hass"))this.__checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var e,i=(0,a.A)(t.keys());try{for(i.s();!(e=i.n()).done;){var s=e.value;if(this.hassSubscribeRequiredHostProps.includes(s))return void this.__checkSubscribed()}}catch(r){i.e(r)}finally{i.f()}}}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"__checkSubscribed",value:function(){var t,e=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some((function(t){return void 0===e[t]}))||(this.__unsubs=this.hassSubscribe())}}]}}),t);return e}},23469:function(t,e,n){n.d(e,{g:function(){return s}});n(79641);var a=n(3254),i=n(92164);function s(t,e,n,s,r,o){var c=t.getPropertyValue(r+"-"+o).trim(),d=c.length>0?c:t.getPropertyValue(r).trim(),u=(0,a.RQ)(d);return 0===c.length&&o&&(u=(0,a.v2)((0,a.BE)(e?(0,i.T)((0,a.Nc)((0,a.xp)(u)),o):(0,i.d)((0,a.Nc)((0,a.xp)(u)),o)))),s?u+=n?"32":"7F":n&&(u+="7F"),u}},37334:function(t,e,n){var a=n(22858).A,i=n(33994).A;n.a(t,function(){var t=a(i().mark((function t(a,s){var r,o,c,d,u,l,h,f,v,p,k,_,b;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,b=function(t,e,n,a,i,s,r){var o=(0,d.c)(e,t),c=void 0!==s&&void 0!==r;if(c&&o<=35){var p=(0,u.M)(e,t),k=(0,u.M)(r,s);k>p?e=(0,l.L)(e,k-p):p>k&&(r=(0,l.L)(r,p-k))}var b={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:_(o,e),adapters:{date:{locale:n,config:a}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},time:{tooltipFormat:o>35?"monthyear":o>7?"date":o>2?"weekday":o>0?"datetime":"hour",minUnit:o>35?"month":o>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:i},ticks:{beginAtZero:!0,callback:function(t){return(0,h.ZV)(Math.abs(t),n)}}}},plugins:{tooltip:{position:"nearest",filter:function(t){return"0"!==t.formattedValue},itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:function(t){if(o>0)return t[0].label;var e=new Date(t[0].parsed.x);return"".concat(c?"".concat((0,f.sl)(e,n,a),": "):"").concat((0,v.fU)(e,n,a)," â€“ ").concat((0,v.fU)((0,l.L)(e,1),n,a))},label:function(t){return"".concat(t.dataset.label,": ").concat((0,h.ZV)(t.parsed.y,n)," ").concat(i)}}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,h.Yf)(n)};return c&&(b.scales.xAxisCompare=Object.assign(Object.assign({},b.scales.x),{},{suggestedMin:s.getTime(),max:_(o,r),display:!1})),b},_=function(t,e){var n=new Date(e);return t>2&&0===n.getHours()&&(n=(0,c.O)(n,1)),n.setMinutes(0,0,0),t>35&&n.setDate(1),t>2&&n.setHours(0),n.getTime()},n.d(e,{o:function(){return b}}),r=n(81027),o=n(26098),c=n(22874),d=n(74312),u=n(56180),l=n(97405),h=n(57636),f=n(57289),v=n(41924),!(p=a([h,f,v])).then){t.next=23;break}return t.next=19,p;case 19:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=24;break;case 23:t.t0=p;case 24:k=t.t0,h=k[0],f=k[1],v=k[2],s(),t.next=34;break;case 31:t.prev=31,t.t2=t.catch(0),s(t.t2);case 34:case"end":return t.stop()}}),t,null,[[0,31]])})));return function(e,n){return t.apply(this,arguments)}}())},1799:function(t,e,n){var a=n(22858).A,i=n(33994).A;n.a(t,function(){var t=a(i().mark((function t(a,s){var r,o,c,d,u,l,h,f,v,p,k,_,b,g,y,m,x,S,A,w,C,E,D,O,I,V,P,M,H,R,U,j,z,F,q,L,N,T,Z,J,K,Q,W,$,B,G,Y,X;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.r(e),n.d(e,{HuiEnergyDevicesDetailGraphCard:function(){return X}}),r=n(64782),o=n(41981),c=n(64599),d=n(35806),u=n(71008),l=n(62193),h=n(2816),f=n(27927),v=n(81027),p=n(13025),k=n(82386),_=n(39805),b=n(97741),g=n(89655),y=n(33231),m=n(50693),x=n(29193),S=n(26098),A=n(10507),w=n(39790),C=n(36604),E=n(253),D=n(2075),O=n(54846),I=n(16891),V=n(66555),P=n(34953),M=n(59298),H=n(15112),R=n(29818),U=n(85323),j=n(94100),z=n(46999),F=n(23469),n(13082),q=n(47076),L=n(4826),N=n(20712),T=n(7934),Z=n(37334),J=n(34897),K=n(96979),Q=n(56136),!(W=a([q,Z])).then){t.next=72;break}return t.next=68,W;case 68:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=73;break;case 72:t.t0=W;case 73:$=t.t0,q=$[0],Z=$[1],X=(0,f.A)([(0,R.EM)("hui-energy-devices-detail-graph-card")],(function(t,e){var n=function(e){function n(){var e;(0,u.A)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return e=(0,l.A)(this,n,[].concat(i)),t(e),e}return(0,h.A)(n,e),(0,d.A)(n)}(e);return{F:n,d:[{kind:"field",decorators:[(0,R.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,R.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,R.wk)()],key:"_chartData",value:function(){return{datasets:[]}}},{kind:"field",decorators:[(0,R.wk)()],key:"_chartDatasetExtra",value:function(){return[]}},{kind:"field",decorators:[(0,R.wk)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,R.wk)()],key:"_start",value:function(){return(0,P.R)()}},{kind:"field",decorators:[(0,R.wk)()],key:"_end",value:function(){return(0,M.o)()}},{kind:"field",decorators:[(0,R.wk)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,R.wk)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,K.I)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],key:"_hiddenStats",value:function(){return[]}},{kind:"field",key:"_untrackedIndex",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,e=this;return[(0,q.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){e._data=t,e._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,T.xP)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?(0,H.qy)(B||(B=(0,c.A)([" <ha-card> ",' <div class="content ','"> <ha-chart-base externalHidden .hass="','" .data="','" .extraData="','" .options="','" chart-type="bar" @dataset-hidden="','" @dataset-unhidden="','"></ha-chart-base> </div> </ha-card> '])),this._config.title?(0,H.qy)(G||(G=(0,c.A)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,U.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._chartDatasetExtra,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,"kWh",this._compareStart,this._compareEnd),this._datasetHidden,this._datasetUnhidden):H.s6}},{kind:"method",key:"_datasetHidden",value:function(t){var e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=[].concat((0,o.A)(this._hiddenStats),[e])}},{kind:"method",key:"_datasetUnhidden",value:function(t){var e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=this._hiddenStats.filter((function(t){return t!==e}))}},{kind:"field",key:"_createOptions",value:function(){var t=this;return(0,j.A)((function(e,n,a,i,s,r,o){var c=(0,Z.o)(e,n,a,i,s,r,o);return Object.assign(Object.assign({},c),{},{interaction:{mode:"nearest"},plugins:Object.assign(Object.assign({},c.plugins),{},{legend:{display:!0,labels:{usePointStyle:!0}}}),onClick:function(e,n,a){var i,s,r,o;if(!(0,Q.a)(e)){var c=null!==(i=null===(s=n[0])||void 0===s?void 0:s.datasetIndex)&&void 0!==i?i:-1;if(!(c<0)){var d=null===(r=t._data)||void 0===r||null===(r=r.prefs.device_consumption[c])||void 0===r?void 0:r.stat_consumption;d&&!(0,L.OQ)(d)&&((0,J.r)(t,"hass-more-info",{entityId:d}),null==a||null===(o=a.canvas)||void 0===o||o.dispatchEvent(new Event("mouseout")))}}}})}))}},{kind:"method",key:"_processStatistics",value:function(){var t=this._data,e=t.stats,n=t.statsCompare,a=getComputedStyle(this),i={};t.prefs.device_consumption.forEach((function(t){var n=t.stat_consumption in e&&(0,L.$j)(e[t.stat_consumption])||0;i[t.stat_consumption]=n}));var s=t.prefs.device_consumption.map((function(t){return t.stat_consumption}));s.sort((function(t,e){return i[e]-i[t]}));var r=[],c=[],d=this._processDataSet(a,e,t.statsMetadata,t.prefs.device_consumption,s),u=d.data,l=d.dataExtras;r.push.apply(r,(0,o.A)(u)),c.push.apply(c,(0,o.A)(l));var h=(0,q.gv)(t),f=h.summedData,v=h.compareSummedData,p="from_grid"in f||"solar"in f||"from_battery"in f,k=p?(0,q.DR)(f,v):{consumption:void 0,compareConsumption:void 0},_=k.consumption,b=k.compareConsumption;if(p){this._untrackedIndex=r.length;var g=this._processUntracked(a,u,_,!1),y=g.dataset,m=g.datasetExtra;r.push(y),c.push(m)}if(n){r.push({order:0,data:[]}),c.push({show_legend:!1}),r.push({order:999,data:[],xAxisID:"xAxisCompare"}),c.push({show_legend:!1});var x=this._processDataSet(a,n,t.statsMetadata,t.prefs.device_consumption,s,!0),S=x.data,A=x.dataExtras;if(r.push.apply(r,(0,o.A)(S)),c.push.apply(c,(0,o.A)(A)),p){var w=this._processUntracked(a,S,b,!0),C=w.dataset,E=w.datasetExtra;r.push(C),c.push(E)}}this._start=t.start,this._end=t.end||(0,M.o)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:r},this._chartDatasetExtra=c}},{kind:"method",key:"_processUntracked",value:function(t,e,n,a){var i={};e.forEach((function(t){t.data.forEach((function(t){i[t.x]=(i[t.x]||0)+t.y}))}));var s=[];return Object.keys(n.total).forEach((function(t){s.push({x:Number(t),y:n.total[t]-(i[t]||0)})})),{dataset:{label:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked_consumption"),hidden:this._hiddenStats.includes("untracked"),borderColor:(0,F.g)(t,this.hass.themes.darkMode,!1,a,"--state-unavailable-color"),backgroundColor:(0,F.g)(t,this.hass.themes.darkMode,!0,a,"--state-unavailable-color"),data:s,order:1+this._untrackedIndex,stack:"devices",pointStyle:!a&&"circle",xAxisID:a?"xAxisCompare":void 0},datasetExtra:{show_legend:!a}}}},{kind:"method",key:"_processDataSet",value:function(t,e,n,a,i){var s=this,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=[],d=[];return a.forEach((function(a,u){var l,h=(0,z.fI)(u,t),f=null,v=[];if(a.stat_consumption in e){var p,k,_=e[a.stat_consumption],b=(0,r.A)(_);try{for(b.s();!(k=b.n()).done;){var g=k.value;if(null!==g.change&&void 0!==g.change&&f!==g.start){var y=new Date(g.start);v.push({x:y.getTime(),y:g.change}),f=g.start,p=g.end}}}catch(S){b.e(S)}finally{b.f()}1===v.length&&v.push({x:p,y:0})}var m=i.indexOf(a.stat_consumption),x=!!(null!==(l=s._config)&&void 0!==l&&l.max_devices&&m>=s._config.max_devices);c.push({label:a.name||(0,L.$O)(s.hass,a.stat_consumption,n[a.stat_consumption]),hidden:s._hiddenStats.includes(a.stat_consumption)||x,borderColor:o?h+"7F":h,backgroundColor:o?h+"32":h+"7F",data:v,order:1+m,stack:"devices",pointStyle:!o&&"circle",xAxisID:o?"xAxisCompare":void 0}),d.push({show_legend:!o&&!x})})),{data:c,dataExtras:d}}},{kind:"get",static:!0,key:"styles",value:function(){return(0,H.AH)(Y||(Y=(0,c.A)([".card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}"])))}}]}}),(0,N.E)(H.WF)),s(),t.next=84;break;case 81:t.prev=81,t.t2=t.catch(0),s(t.t2);case 84:case"end":return t.stop()}}),t,null,[[0,81]])})));return function(e,n){return t.apply(this,arguments)}}())}}]);
//# sourceMappingURL=1799.y6r9RrBExSk.js.map