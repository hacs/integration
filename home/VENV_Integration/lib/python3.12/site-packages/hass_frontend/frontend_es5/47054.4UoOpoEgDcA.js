"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[47054],{47054:function(e,t,n){n.r(t);var r=n(64782),a=n(41981),i=n(14842),s=n(658),o=n(33994),c=n(22858),u=n(91001),h=n(71008),d=n(35806),l=(n(71499),n(81027),n(13025),n(82386),n(95737),n(79243),n(97741),n(26098),n(39790),n(28552),n(22871),n(66457),n(36016),n(98185),n(7760),n(55228),n(36604),n(99019),n(253),n(5186),n(2075),n(16891),n(4525),n(96858),n(84341),n(49365),n(38389),n(74860),n(71011),n(71174),function(){function e(t,n,r,a,i){var s=this;(0,h.A)(this,e),this._legacyCanvasSize=e.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=t,this.$canvas=document.createElement("canvas"),r&&"object"===(0,u.A)(r)?this._onDecode=n:(r||a||i?console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future"):console.warn("Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=n),n="object"===(0,u.A)(r)?r:{},this._onDecodeError=n.onDecodeError||("function"==typeof r?r:this._onDecodeError),this._calculateScanRegion=n.calculateScanRegion||("function"==typeof a?a:this._calculateScanRegion),this._preferredCamera=n.preferredCamera||i||this._preferredCamera,this._legacyCanvasSize="number"==typeof r?r:"number"==typeof a?a:this._legacyCanvasSize,this._maxScansPerSecond=n.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;var o=!1;if(t.hidden&&(t.hidden=!1,o=!0),document.body.contains(t)||(document.body.appendChild(t),o=!0),r=t.parentElement,n.highlightScanRegion||n.highlightCodeOutline){if(a=!!n.overlay,this.$overlay=n.overlay||document.createElement("div"),(i=this.$overlay.style).position="absolute",i.display="none",i.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!a&&n.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch(c){}r.insertBefore(this.$overlay,this.$video.nextSibling)}n.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame((function(){var e=window.getComputedStyle(t);"none"===e.display&&(t.style.setProperty("display","block","important"),o=!0),"visible"!==e.visibility&&(t.style.setProperty("visibility","visible","important"),o=!0),o&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",s.$overlay&&s.$overlay.parentElement&&s.$overlay.parentElement.removeChild(s.$overlay),delete s.$overlay,delete s.$codeOutlineHighlight),s.$overlay&&s._updateOverlay()})),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=e.createQrEngine()}return(0,d.A)(e,[{key:"hasFlash",value:(O=(0,c.A)((0,o.A)().mark((function t(){var n;return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.$video.srcObject){t.next=7;break}if(this.$video.srcObject instanceof MediaStream){t.next=4;break}return t.abrupt("return",!1);case 4:n=this.$video.srcObject,t.next=10;break;case 7:return t.next=9,this._getCameraStream();case 9:n=t.sent.stream;case 10:return t.abrupt("return","torch"in n.getVideoTracks()[0].getSettings());case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 16:return t.prev=16,n&&n!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),e._stopVideoStream(n)),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[0,13,16,19]])}))),function(){return O.apply(this,arguments)})},{key:"isFlashOn",value:function(){return this._flashOn}},{key:"toggleFlash",value:(S=(0,c.A)((0,o.A)().mark((function e(){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._flashOn){e.next=5;break}return e.next=3,this.turnFlashOff();case 3:e.next=7;break;case 5:return e.next=7,this.turnFlashOn();case 7:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)})},{key:"turnFlashOn",value:(A=(0,c.A)((0,o.A)().mark((function e(){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._flashOn||this._destroyed||(this._flashOn=!0,!this._active||this._paused)){e.next=13;break}return e.prev=1,e.next=4,this.hasFlash();case 4:if(e.sent){e.next=6;break}throw"No flash available";case 6:return e.next=8,this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]});case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),this._flashOn=!1,e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(){return A.apply(this,arguments)})},{key:"turnFlashOff",value:(x=(0,c.A)((0,o.A)().mark((function e(){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._flashOn,!e.t0){e.next=5;break}return this._flashOn=!1,e.next=5,this._restartVideoStream();case 5:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"destroy",value:function(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),e._postWorkerMessage(this._qrEnginePromise,"close")}},{key:"start",value:(w=(0,c.A)((0,o.A)().mark((function t(){var n,r,a;return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._destroyed){t.next=2;break}throw Error("The QR scanner can not be started as it had been destroyed.");case 2:if(this._active&&!this._paused){t.next=30;break}if("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,document.hidden){t.next=30;break}if(this._paused=!1,!this.$video.srcObject){t.next=9;break}return t.next=7,this.$video.play();case 7:t.next=30;break;case 9:return t.prev=9,t.next=12,this._getCameraStream();case 12:if(n=t.sent,r=n.stream,a=n.facingMode,this._active&&!this._paused){t.next=19;break}e._stopVideoStream(r),t.next=24;break;case 19:return this._setVideoMirror(a),this.$video.srcObject=r,t.next=23,this.$video.play();case 23:this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch((function(){})));case 24:t.next=30;break;case 26:if(t.prev=26,t.t0=t.catch(9),this._paused){t.next=30;break}throw this._active=!1,t.t0;case 30:case"end":return t.stop()}}),t,this,[[9,26]])}))),function(){return w.apply(this,arguments)})},{key:"stop",value:function(){this.pause(),this._active=!1}},{key:"pause",value:(k=(0,c.A)((0,o.A)().mark((function t(){var n,r,a=this,i=arguments;return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.length>0&&void 0!==i[0]&&i[0],this._paused=!0,this._active){t.next=4;break}return t.abrupt("return",!0);case 4:if(this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none"),r=function(){a.$video.srcObject instanceof MediaStream&&(e._stopVideoStream(a.$video.srcObject),a.$video.srcObject=null)},!n){t.next=9;break}return t.abrupt("return",(r(),!0));case 9:return t.next=11,new Promise((function(e){return setTimeout(e,300)}));case 11:if(this._paused){t.next=13;break}return t.abrupt("return",!1);case 13:return r(),t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t,this)}))),function(){return k.apply(this,arguments)})},{key:"setCamera",value:(b=(0,c.A)((0,o.A)().mark((function e(t){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t!==this._preferredCamera,!e.t0){e.next=5;break}return this._preferredCamera=t,e.next=5,this._restartVideoStream();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"setGrayscaleWeights",value:function(t,n,r){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:n,blue:r,useIntegerApproximation:a})}},{key:"setInversionMode",value:function(t){e._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}},{key:"_onPlay",value:function(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}},{key:"_onLoadedMetaData",value:function(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}},{key:"_onVisibilityChange",value:function(){document.hidden?this.pause():this._active&&this.start()}},{key:"_calculateScanRegion",value:function(e){var t=Math.round(2/3*Math.min(e.videoWidth,e.videoHeight));return{x:Math.round((e.videoWidth-t)/2),y:Math.round((e.videoHeight-t)/2),width:t,height:t,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}},{key:"_updateOverlay",value:function(){var e=this;requestAnimationFrame((function(){if(e.$overlay){var t=e.$video,n=t.videoWidth,r=t.videoHeight,a=t.offsetWidth,i=t.offsetHeight,o=t.offsetLeft,c=t.offsetTop,u=window.getComputedStyle(t),h=u.objectFit,d=n/r,l=a/i;switch(h){case"none":var v=n,f=r;break;case"fill":v=a,f=i;break;default:("cover"===h?d>l:d<l)?v=(f=i)*d:f=(v=a)/d,"scale-down"===h&&(v=Math.min(v,n),f=Math.min(f,r))}var p=u.objectPosition.split(" ").map((function(e,t){var n=parseFloat(e);return e.endsWith("%")?(t?i-f:a-v)*n/100:n})),g=(0,s.A)(p,2),m=g[0],y=g[1];u=e._scanRegion.width||n,l=e._scanRegion.height||r,h=e._scanRegion.x||0;var _=e._scanRegion.y||0;(d=e.$overlay.style).width="".concat(u/n*v,"px"),d.height="".concat(l/r*f,"px"),d.top="".concat(c+y+_/r*f,"px"),r=/scaleX\(-1\)/.test(t.style.transform),d.left="".concat(o+(r?a-m-v:m)+(r?n-h-u:h)/n*v,"px"),d.transform=t.style.transform}}))}},{key:"_scanFrame",value:function(){var t=this;!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)((0,c.A)((0,o.A)().mark((function n(){var r,a,i;return(0,o.A)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(1>=t.$video.readyState){n.next=29;break}if(r=Date.now()-t._lastScanTimestamp,a=1e3/t._maxScansPerSecond,n.t0=r<a,!n.t0){n.next=6;break}return n.next=6,new Promise((function(e){return setTimeout(e,a-r)}));case 6:return t._lastScanTimestamp=Date.now(),n.prev=7,n.next=10,e.scanImage(t.$video,{scanRegion:t._scanRegion,qrEngine:t._qrEnginePromise,canvas:t.$canvas});case 10:i=n.sent,n.next=18;break;case 13:if(n.prev=13,n.t1=n.catch(7),t._active){n.next=17;break}return n.abrupt("return");case 17:t._onDecodeError(n.t1);case 18:if(n.t2=!e._disableBarcodeDetector,n.t2){n.next=25;break}return n.next=22,t._qrEnginePromise;case 22:n.t3=n.sent,n.t4=Worker,n.t2=n.t3 instanceof n.t4;case 25:if(n.t5=n.t2,n.t5){n.next=28;break}t._qrEnginePromise=e.createQrEngine();case 28:i?(t._onDecode?t._onDecode(i):t._legacyOnDecode&&t._legacyOnDecode(i.data),t.$codeOutlineHighlight&&(clearTimeout(t._codeOutlineHighlightRemovalTimeout),t._codeOutlineHighlightRemovalTimeout=void 0,t.$codeOutlineHighlight.setAttribute("viewBox","".concat(t._scanRegion.x||0," ")+"".concat(t._scanRegion.y||0," ")+"".concat(t._scanRegion.width||t.$video.videoWidth," ")+"".concat(t._scanRegion.height||t.$video.videoHeight)),t.$codeOutlineHighlight.firstElementChild.setAttribute("points",i.cornerPoints.map((function(e){var t=e.x,n=e.y;return"".concat(t,",").concat(n)})).join(" ")),t.$codeOutlineHighlight.style.display="")):t.$codeOutlineHighlight&&!t._codeOutlineHighlightRemovalTimeout&&(t._codeOutlineHighlightRemovalTimeout=setTimeout((function(){return t.$codeOutlineHighlight.style.display="none"}),100));case 29:t._scanFrame();case 30:case"end":return n.stop()}}),n,null,[[7,13]])}))))}},{key:"_onDecodeError",value:function(t){t!==e.NO_QR_CODE_FOUND&&console.log(t)}},{key:"_getCameraStream",value:(_=(0,c.A)((0,o.A)().mark((function e(){var t,n,r,s,c,u,h,d,l=this;return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices){e.next=2;break}throw"Camera not found.";case 2:t=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",r=(n=[{width:{min:1024}},{width:{min:768}},{}]).map((function(e){return Object.assign({},e,(0,i.A)({},t,{exact:l._preferredCamera}))})),s=0,c=[].concat((0,a.A)(r),n);case 4:if(!(s<c.length)){e.next=19;break}return u=c[s],e.prev=6,e.next=9,navigator.mediaDevices.getUserMedia({video:u,audio:!1});case 9:return h=e.sent,d=this._getFacingMode(h)||(u.facingMode?this._preferredCamera:"environment"===this._preferredCamera?"user":"environment"),e.abrupt("return",{stream:h,facingMode:d});case 14:e.prev=14,e.t0=e.catch(6);case 16:s++,e.next=4;break;case 19:throw"Camera not found.";case 20:case"end":return e.stop()}}),e,this,[[6,14]])}))),function(){return _.apply(this,arguments)})},{key:"_restartVideoStream",value:(y=(0,c.A)((0,o.A)().mark((function e(){var t;return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._paused,e.next=3,this.pause(!0);case 3:if(e.t1=e.sent,!e.t1){e.next=6;break}e.t1=!t;case 6:if(e.t0=e.t1,!e.t0){e.next=9;break}e.t0=this._active;case 9:if(e.t2=e.t0,!e.t2){e.next=13;break}return e.next=13,this.start();case 13:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"_setVideoMirror",value:function(e){this.$video.style.transform="scaleX("+("user"===e?-1:1)+")"}},{key:"_getFacingMode",value:function(e){return(e=e.getVideoTracks()[0])?/rear|back|environment/i.test(e.label)?"environment":/front|user|face/i.test(e.label)?"user":null:null}}],[{key:"WORKER_PATH",set:function(e){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}},{key:"hasCamera",value:(m=(0,c.A)((0,o.A)().mark((function t(){return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.listCameras(!1);case 3:return t.abrupt("return",!!t.sent.length);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(){return m.apply(this,arguments)})},{key:"listCameras",value:(g=(0,c.A)((0,o.A)().mark((function t(){var n,r,a,i=arguments;return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.length>0&&void 0!==i[0]&&i[0],navigator.mediaDevices){t.next=3;break}return t.abrupt("return",[]);case 3:if(r=function(){var e=(0,c.A)((0,o.A)().mark((function e(){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return e.abrupt("return",e.sent.filter((function(e){return"videoinput"===e.kind})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.prev=4,t.t0=n,!t.t0){t.next=10;break}return t.next=9,r();case 9:t.t0=t.sent.every((function(e){return!e.label}));case 10:if(t.t1=t.t0,!t.t1){t.next=15;break}return t.next=14,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 14:a=t.sent;case 15:t.next=19;break;case 17:t.prev=17,t.t2=t.catch(4);case 19:return t.prev=19,t.next=22,r();case 22:return t.abrupt("return",t.sent.map((function(e,t){return{id:e.deviceId,label:e.label||(0===t?"Default Camera":"Camera ".concat(t+1))}})));case 23:return t.prev=23,a&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),e._stopVideoStream(a)),t.finish(23);case 26:case"end":return t.stop()}}),t,null,[[4,17],[19,,23,26]])}))),function(){return g.apply(this,arguments)})},{key:"scanImage",value:(p=(0,c.A)((0,o.A)().mark((function t(n,r,a,i){var u,h,d,l,v,f,p,g,m,y,_,b,k,w=arguments;return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=w.length>4&&void 0!==w[4]&&w[4],h=w.length>5&&void 0!==w[5]&&w[5],l=!1,r&&("scanRegion"in r||"qrEngine"in r||"canvas"in r||"disallowCanvasResizing"in r||"alsoTryWithoutScanRegion"in r||"returnDetailedScanResult"in r)?(d=r.scanRegion,a=r.qrEngine,i=r.canvas,u=r.disallowCanvasResizing||!1,h=r.alsoTryWithoutScanRegion||!1,l=!0):r||a||i||u||h?console.warn("You're using a deprecated api for scanImage which will be removed in the future."):console.warn("Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),r=!!a,t.prev=5,t.next=8,Promise.all([a||e.createQrEngine(),e._loadImage(n)]);case 8:if(p=t.sent,g=(0,s.A)(p,2),a=g[0],v=g[1],m=e._drawToCanvas(v,d,i,u),y=(0,s.A)(m,2),i=y[0],f=y[1],!(a instanceof Worker)){t.next=24;break}return b=a,r||e._postWorkerMessageSync(b,"inversionMode","both"),t.next=21,new Promise((function(t,n){var r,a,s,o=-1;a=function(i){i.data.id===o&&(b.removeEventListener("message",a),b.removeEventListener("error",s),clearTimeout(r),null!==i.data.data?t({data:i.data.data,cornerPoints:e._convertPoints(i.data.cornerPoints,d)}):n(e.NO_QR_CODE_FOUND))},s=function(e){b.removeEventListener("message",a),b.removeEventListener("error",s),clearTimeout(r),n("Scanner error: "+(e?e.message||e:"Unknown Error"))},b.addEventListener("message",a),b.addEventListener("error",s),r=setTimeout((function(){return s("timeout")}),1e4);var c=f.getImageData(0,0,i.width,i.height);o=e._postWorkerMessageSync(b,"decode",c,[c.data.buffer])}));case 21:_=t.sent,t.next=27;break;case 24:return t.next=26,Promise.race([new Promise((function(e,t){return window.setTimeout((function(){return t("Scanner error: timeout")}),1e4)})),(0,c.A)((0,o.A)().mark((function t(){var r,c,l;return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.detect(i);case 3:if(r=t.sent,c=(0,s.A)(r,1),l=c[0]){t.next=8;break}throw e.NO_QR_CODE_FOUND;case 8:return t.abrupt("return",{data:l.rawValue,cornerPoints:e._convertPoints(l.cornerPoints,d)});case 11:if(t.prev=11,t.t0=t.catch(0),l=t.t0.message||t.t0,!/not implemented|service unavailable/.test(l)){t.next=16;break}return t.abrupt("return",(e._disableBarcodeDetector=!0,e.scanImage(n,{scanRegion:d,canvas:i,disallowCanvasResizing:u,alsoTryWithoutScanRegion:h})));case 16:throw"Scanner error: ".concat(l);case 17:case"end":return t.stop()}}),t,null,[[0,11]])})))()]);case 26:_=t.sent;case 27:return t.abrupt("return",l?_:_.data);case 30:if(t.prev=30,t.t0=t.catch(5),d&&h){t.next=34;break}throw t.t0;case 34:return t.next=36,e.scanImage(n,{qrEngine:a,canvas:i,disallowCanvasResizing:u});case 36:return k=t.sent,t.abrupt("return",l?k:k.data);case 38:return t.prev=38,r||e._postWorkerMessage(a,"close"),t.finish(38);case 41:case"end":return t.stop()}}),t,null,[[5,30,38,41]])}))),function(e,t,n,r){return p.apply(this,arguments)})},{key:"createQrEngine",value:(f=(0,c.A)((0,o.A)().mark((function t(r){var a;return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&console.warn("Specifying a worker path is not required and not supported anymore."),r=function(){return n.e(76465).then(n.bind(n,76465)).then((function(e){return e.createWorker()}))},t.t0=!e._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats,!t.t0){t.next=7;break}return t.next=6,BarcodeDetector.getSupportedFormats();case 6:t.t0=t.sent.includes("qr_code");case 7:if(t.t0){t.next=9;break}return t.abrupt("return",r());case 9:if(a=navigator.userAgentData,t.t1=a&&a.brands.some((function(e){var t=e.brand;return/Chromium/i.test(t)}))&&/mac ?OS/i.test(a.platform),!t.t1){t.next=15;break}return t.next=14,a.getHighEntropyValues(["architecture","platformVersion"]).then((function(e){var t=e.architecture,n=e.platformVersion;return/arm/i.test(t||"arm")&&13<=parseInt(n||"13")})).catch((function(){return!0}));case 14:t.t1=t.sent;case 15:if(!t.t1){t.next=19;break}t.t2=r(),t.next=20;break;case 19:t.t2=new BarcodeDetector({formats:["qr_code"]});case 20:return t.abrupt("return",t.t2);case 21:case"end":return t.stop()}}),t)}))),function(e){return f.apply(this,arguments)})},{key:"_convertPoints",value:function(e,t){if(!t)return e;var n=t.x||0,a=t.y||0,i=t.width&&t.downScaledWidth?t.width/t.downScaledWidth:1;t=t.height&&t.downScaledHeight?t.height/t.downScaledHeight:1;var s,o=(0,r.A)(e);try{for(o.s();!(s=o.n()).done;){var c=s.value;c.x=c.x*i+n,c.y=c.y*t+a}}catch(u){o.e(u)}finally{o.f()}return e}},{key:"_stopVideoStream",value:function(e){var t,n=(0,r.A)(e.getTracks());try{for(n.s();!(t=n.n()).done;){var a=t.value;a.stop(),e.removeTrack(a)}}catch(i){n.e(i)}finally{n.f()}}},{key:"_drawToCanvas",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n=n||document.createElement("canvas");var a=t&&t.x?t.x:0,i=t&&t.y?t.y:0,s=t&&t.width?t.width:e.videoWidth||e.width,o=t&&t.height?t.height:e.videoHeight||e.height;return r||(r=t&&t.downScaledWidth?t.downScaledWidth:s,t=t&&t.downScaledHeight?t.downScaledHeight:o,n.width!==r&&(n.width=r),n.height!==t&&(n.height=t)),(t=n.getContext("2d",{alpha:!1})).imageSmoothingEnabled=!1,t.drawImage(e,a,i,s,o,0,0,n.width,n.height),[n,t]}},{key:"_loadImage",value:(v=(0,c.A)((0,o.A)().mark((function t(n){var r;return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n instanceof Image)){t.next=4;break}return t.next=3,e._awaitImageLoad(n);case 3:return t.abrupt("return",n);case 4:if(!(n instanceof HTMLVideoElement||n instanceof HTMLCanvasElement||n instanceof SVGImageElement||"OffscreenCanvas"in window&&n instanceof OffscreenCanvas||"ImageBitmap"in window&&n instanceof ImageBitmap)){t.next=6;break}return t.abrupt("return",n);case 6:if(!(n instanceof File||n instanceof Blob||n instanceof URL||"string"==typeof n)){t.next=18;break}return(r=new Image).src=n instanceof File||n instanceof Blob?URL.createObjectURL(n):n.toString(),t.prev=9,t.next=12,e._awaitImageLoad(r);case 12:return t.abrupt("return",r);case 13:return t.prev=13,(n instanceof File||n instanceof Blob)&&URL.revokeObjectURL(r.src),t.finish(13);case 16:t.next=19;break;case 18:throw"Unsupported image type.";case 19:case"end":return t.stop()}}),t,null,[[9,,13,16]])}))),function(e){return v.apply(this,arguments)})},{key:"_awaitImageLoad",value:(l=(0,c.A)((0,o.A)().mark((function e(t){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.complete&&0!==t.naturalWidth,e.t0){e.next=4;break}return e.next=4,new Promise((function(e,n){var r=function(a){t.removeEventListener("load",r),t.removeEventListener("error",r),a instanceof ErrorEvent?n("Image load error"):e()};t.addEventListener("load",r),t.addEventListener("error",r)}));case 4:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"_postWorkerMessage",value:(t=(0,c.A)((0,o.A)().mark((function t(n,r,a,i){return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,n;case 3:return t.t1=t.sent,t.t2=r,t.t3=a,t.t4=i,t.abrupt("return",t.t0._postWorkerMessageSync.call(t.t0,t.t1,t.t2,t.t3,t.t4));case 8:case"end":return t.stop()}}),t)}))),function(e,n,r,a){return t.apply(this,arguments)})},{key:"_postWorkerMessageSync",value:function(t,n,r,a){if(!(t instanceof Worker))return-1;var i=e._workerMessageId++;return t.postMessage({id:i,type:n,data:r},a),i}}]);var t,l,v,f,p,g,m,y,_,b,k,w,x,A,S,O}());l.DEFAULT_CANVAS_SIZE=400,l.NO_QR_CODE_FOUND="No QR code found",l._disableBarcodeDetector=!1,l._workerMessageId=0,t.default=l},52043:function(e,t,n){var r=n(21621),a=n(26906),i=n(13113),s=n(53138),o=n(38971).trim,c=n(69329),u=i("".charAt),h=r.parseFloat,d=r.Symbol,l=d&&d.iterator,v=1/h(c+"-0")!=-1/0||l&&!a((function(){h(Object(l))}));e.exports=v?function(e){var t=o(s(e)),n=h(t);return 0===n&&"-"===u(t,0)?-0:n}:h},28552:function(e,t,n){var r=n(41765),a=n(52043);r({global:!0,forced:parseFloat!==a},{parseFloat:a})},5186:function(e,t,n){var r=n(41765),a=n(73201),i=n(95689),s=n(56674),o=n(1370);r({target:"Iterator",proto:!0,real:!0},{every:function(e){s(this),i(e);var t=o(this),n=0;return!a(t,(function(t,r){if(!e(t,n++))return r()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}}]);
//# sourceMappingURL=47054.4UoOpoEgDcA.js.map