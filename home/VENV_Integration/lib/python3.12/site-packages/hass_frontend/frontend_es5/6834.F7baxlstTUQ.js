"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[6834],{20712:function(t,n,e){e.d(n,{E:function(){return d}});var i=e(64782),r=e(35806),a=e(71008),u=e(62193),o=e(2816),s=e(27927),l=e(35890),c=(e(81027),e(82386),e(95737),e(39790),e(66457),e(36604),e(253),e(4525),e(96858),e(29818)),d=function(t){var n=(0,s.A)(null,(function(t,n){var e=function(n){function e(){var n;(0,a.A)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=(0,u.A)(this,e,[].concat(r)),t(n),n}return(0,o.A)(e,n),(0,r.A)(e)}(n);return{F:e,d:[{kind:"field",decorators:[(0,c.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,l.A)(e,"connectedCallback",this,3)([]),this.__checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,l.A)(e,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){var t=this.__unsubs.pop();t instanceof Promise?t.then((function(t){return t()})):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,l.A)(e,"updated",this,3)([t]),t.has("hass"))this.__checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var n,r=(0,i.A)(t.keys());try{for(r.s();!(n=r.n()).done;){var a=n.value;if(this.hassSubscribeRequiredHostProps.includes(a))return void this.__checkSubscribed()}}catch(u){r.e(u)}finally{r.f()}}}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"__checkSubscribed",value:function(){var t,n=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some((function(t){return void 0===n[t]}))||(this.__unsubs=this.hassSubscribe())}}]}}),t);return n}},16025:function(t,n,e){var i=e(22858).A,r=e(33994).A;e.a(t,function(){var t=i(r().mark((function t(i,a){var u,o,s,l,c,d,f,h,v,g,_,p,y,k,b,m,x,A,w,M,F,S,z,H,q;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.r(n),u=e(64599),o=e(35806),s=e(71008),l=e(62193),c=e(2816),d=e(27927),f=e(81027),h=e(97741),v=e(16891),e(7986),g=e(15112),_=e(29818),p=e(63073),e(13082),y=e(43106),e(88400),k=e(47076),b=e(4826),m=e(20712),x=e(57540),A=e(7934),!(w=i([y,k,x])).then){t.next=34;break}return t.next=30,w;case 30:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=35;break;case 34:t.t0=w;case 35:M=t.t0,y=M[0],k=M[1],x=M[2],q={maximumFractionDigits:0},(0,d.A)([(0,_.EM)("hui-energy-self-sufficiency-gauge-card")],(function(t,n){var e=function(n){function e(){var n;(0,s.A)(this,e);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=(0,l.A)(this,e,[].concat(r)),t(n),n}return(0,c.A)(e,n),(0,o.A)(e)}(n);return{F:e,d:[{kind:"field",decorators:[(0,_.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,_.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,_.wk)()],key:"_data",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,n=this;return[(0,k.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){n._data=t}))]}},{kind:"method",key:"getCardSize",value:function(){return 4}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,A.xP)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"render",value:function(){var t;if(!this._config||!this.hass)return g.s6;if(!this._data)return(0,g.qy)(F||(F=(0,u.A)(["",""])),this.hass.localize("ui.panel.lovelace.cards.energy.loading"));var n=this._data.prefs,e=(0,k.E$)(n),i=void 0!==e.solar,r=void 0!==e.battery,a=e.grid[0].flow_to.length>0,o=null!==(t=(0,b.gF)(this._data.stats,e.grid[0].flow_from.map((function(t){return t.stat_energy_from}))))&&void 0!==t?t:0,s=null;i&&(s=(0,b.gF)(this._data.stats,e.solar.map((function(t){return t.stat_energy_from})))||0);var l=null,c=null;r&&(l=(0,b.gF)(this._data.stats,e.battery.map((function(t){return t.stat_energy_to})))||0,c=(0,b.gF)(this._data.stats,e.battery.map((function(t){return t.stat_energy_from})))||0);var d=null;a&&(d=(0,b.gF)(this._data.stats,e.grid[0].flow_to.map((function(t){return t.stat_energy_to})))||0);var f=null;i&&(f=(s||0)-(d||0)-(l||0));var h=null,v=null;null!==f&&f<0&&(r&&(h=-1*f)>o&&(v=h-o,h=o),f=0);var _=null;r&&(_=(c||0)-(v||0));var y,m=Math.max(0,o-(h||0)),x=Math.max(0,m+(f||0)+(_||0));return null!==o&&null!==x&&x>0&&(y=100*(1-o/x)),(0,g.qy)(S||(S=(0,u.A)([" <ha-card> "," </ha-card> "])),void 0!==y?(0,g.qy)(z||(z=(0,u.A)([' <ha-svg-icon id="info" .path="','"></ha-svg-icon> <simple-tooltip animation-delay="0" for="info" position="left"> <span> ',' </span> </simple-tooltip> <ha-gauge min="0" max="100" .value="','" label="%" .formatOptions="','" .locale="','" style="','"></ha-gauge> <div class="name"> '," </div> "])),"M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",this.hass.localize("ui.panel.lovelace.cards.energy.self_sufficiency_gauge.card_indicates_self_sufficiency_quota"),y,q,this.hass.locale,(0,p.W)({"--gauge-color":this._computeSeverity(y)}),this.hass.localize("ui.panel.lovelace.cards.energy.self_sufficiency_gauge.self_sufficiency_quota")):this.hass.localize("ui.panel.lovelace.cards.energy.self_sufficiency_gauge.self_sufficiency_could_not_calc"))}},{kind:"method",key:"_computeSeverity",value:function(t){return t>75?x.severityMap.green:t<50?x.severityMap.yellow:x.severityMap.normal}},{kind:"get",static:!0,key:"styles",value:function(){return(0,g.AH)(H||(H=(0,u.A)(["ha-card{height:100%;overflow:hidden;padding:16px;display:flex;align-items:center;justify-content:center;flex-direction:column;box-sizing:border-box}ha-gauge{width:100%;max-width:250px;direction:ltr}.name{text-align:center;line-height:initial;color:var(--primary-text-color);width:100%;font-size:15px;margin-top:8px}ha-svg-icon{position:absolute;right:4px;inset-inline-end:4px;inset-inline-start:initial;top:4px;color:var(--secondary-text-color)}simple-tooltip>span{font-size:12px;line-height:12px}simple-tooltip{width:80%;max-width:250px;top:8px!important}"])))}}]}}),(0,m.E)(g.WF)),a(),t.next=48;break;case 45:t.prev=45,t.t2=t.catch(0),a(t.t2);case 48:case"end":return t.stop()}}),t,null,[[0,45]])})));return function(n,e){return t.apply(this,arguments)}}())},46091:function(t,n,e){e.d(n,{f:function(){return a}});var i=e(76270),r=e(21710);function a(t,n,e){var a=(0,r.a)(t,null==e?void 0:e.in);return isNaN(n)?(0,i.w)((null==e?void 0:e.in)||t,NaN):n?(a.setDate(a.getDate()+n),a):a}},97405:function(t,n,e){e.d(n,{L:function(){return a}});var i=e(34542),r=e(40086);function a(t,n,e){return(0,i.A)(t,n*r.s0,e)}},34542:function(t,n,e){e.d(n,{A:function(){return a}});var i=e(76270),r=e(21710);function a(t,n,e){return(0,i.w)((null==e?void 0:e.in)||t,+(0,r.a)(t)+n)}},56235:function(t,n,e){e.d(n,{P:function(){return a}});var i=e(76270),r=e(21710);function a(t,n,e){var a=(0,r.a)(t,null==e?void 0:e.in);if(isNaN(n))return(0,i.w)((null==e?void 0:e.in)||t,NaN);if(!n)return a;var u=a.getDate(),o=(0,i.w)((null==e?void 0:e.in)||t,a.getTime());return o.setMonth(a.getMonth()+n+1,0),u>=o.getDate()?o:(a.setFullYear(o.getFullYear(),o.getMonth(),u),a)}},73583:function(t,n,e){e.d(n,{z:function(){return r}});var i=e(21710);function r(t,n){var e=+(0,i.a)(t)-+(0,i.a)(n);return e<0?-1:e>0?1:e}},7792:function(t,n,e){e.d(n,{W:function(){return s}});var i=e(658),r=e(52142),a=e(73583);function u(t,n,e){var a=(0,r.x)(null==e?void 0:e.in,t,n),u=(0,i.A)(a,2),o=u[0],s=u[1];return 12*(o.getFullYear()-s.getFullYear())+(o.getMonth()-s.getMonth())}var o=e(76476);function s(t,n,e){var s=(0,r.x)(null==e?void 0:e.in,t,t,n),l=(0,i.A)(s,3),c=l[0],d=l[1],f=l[2],h=(0,a.z)(d,f),v=Math.abs(u(d,f));if(v<1)return 0;1===d.getMonth()&&d.getDate()>27&&d.setDate(30),d.setMonth(d.getMonth()-h*v);var g=(0,a.z)(d,f)===-h;(0,o.c)(c)&&1===v&&1===(0,a.z)(c,f)&&(g=!1);var _=h*(v-+g);return 0===_?0:_}},31077:function(t,n,e){e.d(n,{D:function(){return r}});var i=e(21710);function r(t,n){var e=(0,i.a)(t,null==n?void 0:n.in);return e.setHours(23,59,59,999),e}},4537:function(t,n,e){e.d(n,{p:function(){return r}});var i=e(21710);function r(t,n){var e=(0,i.a)(t,null==n?void 0:n.in),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}},40102:function(t,n,e){e.d(n,{e:function(){return r}});var i=e(21710);function r(t,n){return 1===(0,i.a)(t,null==n?void 0:n.in).getDate()}},76476:function(t,n,e){e.d(n,{c:function(){return u}});var i=e(31077),r=e(4537),a=e(21710);function u(t,n){var e=(0,a.a)(t,null==n?void 0:n.in);return+(0,i.D)(e,n)==+(0,r.p)(e,n)}}}]);
//# sourceMappingURL=6834.F7baxlstTUQ.js.map