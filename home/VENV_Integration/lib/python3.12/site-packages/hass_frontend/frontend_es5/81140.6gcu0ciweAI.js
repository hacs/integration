"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[81140],{37456:function(t,e,i){i.d(e,{a:function(){return n}});var a=(0,i(58034).n)((function(t){history.replaceState({scrollPosition:t},"")}),300),n=function(t){return function(e){return{kind:"method",placement:"prototype",key:e.key,descriptor:{set:function(t){a(t),this["__".concat(String(e.key))]=t},get:function(){var t;return this["__".concat(String(e.key))]||(null===(t=history.state)||void 0===t?void 0:t.scrollPosition)},enumerable:!0,configurable:!0},finisher:function(i){var a=i.prototype.connectedCallback;i.prototype.connectedCallback=function(){var i=this;a.call(this);var n=this[e.key];n&&this.updateComplete.then((function(){var e=i.renderRoot.querySelector(t);e&&setTimeout((function(){e.scrollTop=n}),0)}))}}}}}},64741:function(t,e,i){var a=i(22858).A,n=i(33994).A;i.a(t,function(){var t=a(n().mark((function t(a,r){var s,o,c,u,l,d,h,f,m,v,y,p,k,_,g,b,x,w;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i.r(e),i.d(e,{computeStateDisplay:function(){return x},computeStateDisplayFromEntityAttributes:function(){return w}}),s=i(81027),o=i(82386),c=i(79243),u=i(26098),l=i(36604),d=i(9883),h=i(45269),f=i(9449),m=i(57289),v=i(8581),y=i(41924),p=i(57636),k=i(40863),_=i(213),!(g=a([m,v,y,p])).then){t.next=30;break}return t.next=26,g;case 26:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=31;break;case 30:t.t0=g;case 31:b=t.t0,m=b[0],v=b[1],y=b[2],p=b[3],x=function(t,e,i,a,n,r,s){var o=null==r?void 0:r[e.entity_id];return w(t,i,a,n,o,e.entity_id,e.attributes,void 0!==s?s:e.state)},w=function(t,e,i,a,n,r,s,o){if(o===d.HV||o===d.Hh)return t("state.default.".concat(o));var c=(0,_.m)(r);if((0,p.ty)(s,"sensor"===c?i:[])){if("duration"===s.device_class&&s.unit_of_measurement&&f.Z[s.unit_of_measurement])try{return(0,f.a)(o,s.unit_of_measurement)}catch(w){}if("monetary"===s.device_class)try{return(0,p.ZV)(o,e,Object.assign({style:"currency",currency:s.unit_of_measurement,minimumFractionDigits:2},(0,p.ZQ)({state:o,attributes:s},n)))}catch(w){}var u=(0,p.ZV)(o,e,(0,p.ZQ)({state:o,attributes:s},n)),l=s.unit_of_measurement;return l?"".concat(u).concat((0,k.A)(l,e)).concat(l):u}if("datetime"===c){var g=new Date(o);return(0,v.r6)(g,e,a)}if(["date","input_datetime","time"].includes(c))try{var b=o.split(" ");if(2===b.length)return(0,v.r6)(new Date(b.join("T")),Object.assign(Object.assign({},e),{},{time_zone:h.Wj.local}),a);if(1===b.length){if(o.includes("-"))return(0,m.Yq)(new Date("".concat(o,"T00:00")),Object.assign(Object.assign({},e),{},{time_zone:h.Wj.local}),a);if(o.includes(":")){var x=new Date;return(0,y.fU)(new Date("".concat(x.toISOString().split("T")[0],"T").concat(o)),Object.assign(Object.assign({},e),{},{time_zone:h.Wj.local}),a)}}return o}catch(T){return o}if("counter"===c||"number"===c||"input_number"===c)return(0,p.ZV)(o,e,(0,p.ZQ)({state:o,attributes:s},n));if(["button","conversation","event","image","input_button","notify","scene","stt","tag","tts","wake_word"].includes(c)||"sensor"===c&&"timestamp"===s.device_class)try{return(0,v.r6)(new Date(o),e,a)}catch(w){return o}return(null==n?void 0:n.translation_key)&&t("component.".concat(n.platform,".entity.").concat(c,".").concat(n.translation_key,".state.").concat(o))||s.device_class&&t("component.".concat(c,".entity_component.").concat(s.device_class,".state.").concat(o))||t("component.".concat(c,".entity_component._.state.").concat(o))||o},r(),t.next=44;break;case 41:t.prev=41,t.t2=t.catch(0),r(t.t2);case 44:case"end":return t.stop()}}),t,null,[[0,41]])})));return function(e,i){return t.apply(this,arguments)}}())},56136:function(t,e,i){i.d(e,{a:function(){return a}});var a=function(t){return!(t.native instanceof MouseEvent)||t.native instanceof PointerEvent&&"mouse"!==t.native.pointerType}},64351:function(t,e,i){var a=i(22858).A,n=i(33994).A;i.a(t,function(){var t=a(n().mark((function t(e,a){var r,s,o,c,u,l,d,h,f,m,v,y,p,k,_,g,b,x,w,T,A,M,D,Z,Y,z,S,I;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=i(64599),s=i(35806),o=i(71008),c=i(62193),u=i(2816),l=i(27927),d=i(81027),h=i(89655),f=i(50693),m=i(29193),v=i(39790),y=i(28552),p=i(253),k=i(54846),_=i(4525),g=i(66555),b=i(15112),x=i(29818),w=i(46999),T=i(34897),A=i(40368),M=i(57636),D=i(90701),Z=i(56136),!(Y=e([M])).then){t.next=43;break}return t.next=39,Y;case 39:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=44;break;case 43:t.t0=Y;case 44:M=t.t0[0],S=function(t){var e=parseFloat(t);return isFinite(e)?e:null},I=(0,l.A)(null,(function(t,e){var i=function(e){function i(){var e;(0,o.A)(this,i);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return e=(0,c.A)(this,i,[].concat(n)),t(e),e}return(0,u.A)(i,e),(0,s.A)(i)}(e);return{F:i,d:[{kind:"field",decorators:[(0,x.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,x.MZ)({attribute:!1})],key:"data",value:function(){return[]}},{kind:"field",decorators:[(0,x.MZ)({attribute:!1})],key:"names",value:void 0},{kind:"field",decorators:[(0,x.MZ)()],key:"unit",value:void 0},{kind:"field",decorators:[(0,x.MZ)()],key:"identifier",value:void 0},{kind:"field",decorators:[(0,x.MZ)({type:Boolean})],key:"showNames",value:function(){return!0}},{kind:"field",decorators:[(0,x.MZ)({type:Boolean})],key:"clickForMoreInfo",value:function(){return!0}},{kind:"field",decorators:[(0,x.MZ)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,x.MZ)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,x.MZ)({type:Number})],key:"paddingYAxis",value:function(){return 0}},{kind:"field",decorators:[(0,x.MZ)({type:Number})],key:"chartIndex",value:void 0},{kind:"field",decorators:[(0,x.MZ)({type:Boolean})],key:"logarithmicScale",value:function(){return!1}},{kind:"field",decorators:[(0,x.MZ)({type:Number})],key:"minYAxis",value:void 0},{kind:"field",decorators:[(0,x.MZ)({type:Number})],key:"maxYAxis",value:void 0},{kind:"field",decorators:[(0,x.MZ)({type:Boolean})],key:"fitYData",value:function(){return!1}},{kind:"field",decorators:[(0,x.wk)()],key:"_chartData",value:void 0},{kind:"field",decorators:[(0,x.wk)()],key:"_entityIds",value:function(){return[]}},{kind:"field",key:"_datasetToDataIndex",value:function(){return[]}},{kind:"field",decorators:[(0,x.wk)()],key:"_chartOptions",value:void 0},{kind:"field",decorators:[(0,x.wk)()],key:"_yWidth",value:function(){return 0}},{kind:"field",key:"_chartTime",value:function(){return new Date}},{kind:"field",decorators:[(0,x.P)("ha-chart-base")],key:"_chart",value:void 0},{kind:"field",key:"resize",value:function(){var t=this;return function(e){var i;null===(i=t._chart)||void 0===i||i.resize(e)}}},{kind:"method",key:"render",value:function(){return(0,b.qy)(z||(z=(0,r.A)([' <ha-chart-base .hass="','" .data="','" .options="','" .paddingYAxis="','" chart-type="line"></ha-chart-base> '])),this.hass,this._chartData,this._chartOptions,this.paddingYAxis-this._yWidth)}},{kind:"method",key:"willUpdate",value:function(t){var e=this;(!this.hasUpdated||t.has("showNames")||t.has("startTime")||t.has("endTime")||t.has("unit")||t.has("logarithmicScale")||t.has("minYAxis")||t.has("maxYAxis")||t.has("fitYData"))&&(this._chartOptions={parsing:!1,animation:!1,interaction:{mode:"nearest",axis:"xy"},scales:{x:{type:"time",adapters:{date:{locale:this.hass.locale,config:this.hass.config}},min:this.startTime,suggestedMax:this.endTime,ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,major:{enabled:!0},font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},time:{tooltipFormat:"datetimeseconds"}},y:{suggestedMin:this.fitYData?this.minYAxis:null,suggestedMax:this.fitYData?this.maxYAxis:null,min:this.fitYData?null:this.minYAxis,max:this.fitYData?null:this.maxYAxis,ticks:{maxTicksLimit:7},title:{display:!0,text:this.unit},afterUpdate:function(t){e._yWidth!==Math.floor(t.width)&&(e._yWidth=Math.floor(t.width),(0,T.r)(e,"y-width-changed",{value:e._yWidth,chartIndex:e.chartIndex}))},position:(0,A.qC)(this.hass)?"right":"left",type:this.logarithmicScale?"logarithmic":"linear"}},plugins:{tooltip:{callbacks:{label:function(t){var i="".concat(t.dataset.label,": ").concat((0,M.ZV)(t.parsed.y,e.hass.locale,(0,M.ZQ)(void 0,e.hass.entities[e._entityIds[t.datasetIndex]]))," ").concat(e.unit),a=e._datasetToDataIndex[t.datasetIndex],n=e.data[a];n.statistics&&n.statistics.length>0&&(i+=0===n.states.length||t.parsed.x<n.states[0].last_changed?"\n".concat(e.hass.localize("ui.components.history_charts.source_stats")):"\n".concat(e.hass.localize("ui.components.history_charts.source_history")));return i}}},filler:{propagate:!0},legend:{display:this.showNames,labels:{usePointStyle:!0}}},elements:{line:{tension:.1,borderWidth:1.5},point:{hitRadius:50}},segment:{borderColor:function(t){var i=e._datasetToDataIndex[t.datasetIndex],a=e.data[i];return a.statistics&&a.statistics.length>0&&(0===a.states.length||t.p0.parsed.x<a.states[0].last_changed)?e._chartData.datasets[i].borderColor+"7F":void 0}},locale:(0,M.Yf)(this.hass.locale),onClick:function(t){if(e.clickForMoreInfo&&!(0,Z.a)(t)){var i=t.chart,a=i.getElementsAtEventForMode(t,"nearest",{intersect:!0},!0);if(a.length){var n=a[0];(0,T.r)(e,"hass-more-info",{entityId:e._entityIds[n.datasetIndex]}),i.canvas.dispatchEvent(new Event("mouseout"))}}}}),(t.has("data")||t.has("startTime")||t.has("endTime")||this._chartTime<new Date(this.endTime.getTime()-D.p))&&this._generateData()}},{kind:"method",key:"_generateData",value:function(){var t=this,e=0,i=getComputedStyle(this),a=this.data,n=[],r=[],s=[];if(0!==a.length){this._chartTime=new Date;var o=this.endTime,c=this.names||{};a.forEach((function(a,u){var l=a.domain,d=c[a.entity_id]||a.name,h=null,f=[],m=function(t,e){e&&(t>o||(f.forEach((function(i,a){null===e[a]&&h&&null!==h[a]&&i.data.push({x:t.getTime(),y:h[a]}),i.data.push({x:t.getTime(),y:e[a]})})),h=e))},v=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0;o||(o=(0,w.fI)(e,i),e++),f.push({label:t,fill:!!n&&"origin",borderColor:o,backgroundColor:o+"7F",stepped:"before",pointRadius:0,data:[]}),r.push(a.entity_id),s.push(u)};if("thermostat"===l||"climate"===l||"water_heater"===l){var y=a.states.some((function(t){var e;return null===(e=t.attributes)||void 0===e?void 0:e.hvac_action})),p="climate"===l&&y?function(t){var e;return"heating"===(null===(e=t.attributes)||void 0===e?void 0:e.hvac_action)}:function(t){return"heat"===t.state},k="climate"===l&&y?function(t){var e;return"cooling"===(null===(e=t.attributes)||void 0===e?void 0:e.hvac_action)}:function(t){return"cool"===t.state},_=a.states.some(p),g=a.states.some(k),b=a.states.some((function(t){return t.attributes&&t.attributes.target_temp_high!==t.attributes.target_temp_low}));v("".concat(t.hass.localize("ui.card.climate.current_temperature",{name:d}))),_&&v("".concat(t.hass.localize("ui.card.climate.heating",{name:d})),!0,i.getPropertyValue("--state-climate-heat-color")),g&&v("".concat(t.hass.localize("ui.card.climate.cooling",{name:d})),!0,i.getPropertyValue("--state-climate-cool-color")),b?(v("".concat(t.hass.localize("ui.card.climate.target_temperature_mode",{name:d,mode:t.hass.localize("ui.card.climate.high")}))),v("".concat(t.hass.localize("ui.card.climate.target_temperature_mode",{name:d,mode:t.hass.localize("ui.card.climate.low")})))):v("".concat(t.hass.localize("ui.card.climate.target_temperature_entity",{name:d}))),a.states.forEach((function(t){if(t.attributes){var e=S(t.attributes.current_temperature),i=[e];if(_&&i.push(p(t)?e:null),g&&i.push(k(t)?e:null),b){var a=S(t.attributes.target_temp_high),n=S(t.attributes.target_temp_low);i.push(a,n),m(new Date(t.last_changed),i)}else{var r=S(t.attributes.temperature);i.push(r),m(new Date(t.last_changed),i)}}}))}else if("humidifier"===l){var x=a.states.some((function(t){var e;return null===(e=t.attributes)||void 0===e?void 0:e.action})),T=a.states.some((function(t){var e;return null===(e=t.attributes)||void 0===e?void 0:e.current_humidity})),A=x&&a.states.some((function(t){var e;return"humidifying"===(null===(e=t.attributes)||void 0===e?void 0:e.action)})),M=x&&a.states.some((function(t){var e;return"drying"===(null===(e=t.attributes)||void 0===e?void 0:e.action)}));v("".concat(t.hass.localize("ui.card.humidifier.target_humidity_entity",{name:d}))),T&&v("".concat(t.hass.localize("ui.card.humidifier.current_humidity_entity",{name:d}))),A?v("".concat(t.hass.localize("ui.card.humidifier.humidifying",{name:d})),!0,i.getPropertyValue("--state-humidifier-on-color")):M?v("".concat(t.hass.localize("ui.card.humidifier.drying",{name:d})),!0,i.getPropertyValue("--state-humidifier-on-color")):v("".concat(t.hass.localize("ui.card.humidifier.on_entity",{name:d})),!0),a.states.forEach((function(t){var e;if(t.attributes){var i,a=S(t.attributes.humidity),n=T?S(null===(e=t.attributes)||void 0===e?void 0:e.current_humidity):a,r=[a];if(T&&r.push(n),A)r.push("humidifying"===(null===(i=t.attributes)||void 0===i?void 0:i.action)?n:null);else if(M){var s;r.push("drying"===(null===(s=t.attributes)||void 0===s?void 0:s.action)?n:null)}else r.push("on"===t.state?n:null);m(new Date(t.last_changed),r)}}))}else{var D,Z;v(d);var Y=null,z=function(t){var e=S(t.state),i=new Date(t.last_changed);if(null!==e&&Y){var a,n=i.getTime(),r=Y.getTime(),s=null===(a=Z)||void 0===a?void 0:a.getTime();m(Y,[(r-s)/(n-s)*(e-D)+D]),m(new Date(r+1),[null]),m(i,[e]),Z=i,D=e,Y=null}else null!==e&&null===Y?(m(i,[e]),Z=i,D=e):null===e&&null===Y&&void 0!==D&&(Y=i)};if(a.statistics)for(var I=a.states&&0!==a.states.length?a.states[0].last_changed:0,W=0;W<a.statistics.length&&!(I&&a.statistics[W].last_changed>=I);W++)z(a.statistics[W]);a.states.forEach((function(t){z(t)})),null!==Y&&m(Y,[null])}m(o,h),Array.prototype.push.apply(n,f)})),this._chartData={datasets:n},this._entityIds=r,this._datasetToDataIndex=s}}}]}}),b.WF),customElements.define("state-history-chart-line",I),a(),t.next=54;break;case 51:t.prev=51,t.t2=t.catch(0),a(t.t2);case 54:case"end":return t.stop()}}),t,null,[[0,51]])})));return function(e,i){return t.apply(this,arguments)}}())},26478:function(t,e,i){var a=i(22858).A,n=i(33994).A;i.a(t,function(){var t=a(n().mark((function t(e,a){var r,s,o,c,u,l,d,h,f,m,v,y,p,k,_,g,b,x,w,T,A,M,D,Z,Y,z,S,I,W;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=i(64599),s=i(35806),o=i(71008),c=i(62193),u=i(2816),l=i(27927),d=i(81027),h=i(89655),f=i(50693),m=i(29193),v=i(39790),y=i(253),p=i(54846),k=i(66555),_=i(91293),g=i(15112),b=i(29818),x=i(8581),w=i(37582),T=i(34897),A=i(57636),M=i(40368),D=i(90701),Z=i(73207),Y=i(56136),!(z=e([_,x,A])).then){t.next=42;break}return t.next=38,z;case 38:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=43;break;case 42:t.t0=z;case 43:S=t.t0,_=S[0],x=S[1],A=S[2],(0,l.A)([(0,b.EM)("state-history-chart-timeline")],(function(t,e){var i=function(e){function i(){var e;(0,o.A)(this,i);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return e=(0,c.A)(this,i,[].concat(n)),t(e),e}return(0,u.A)(i,e),(0,s.A)(i)}(e);return{F:i,d:[{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"data",value:function(){return[]}},{kind:"field",decorators:[(0,b.MZ)({type:Boolean})],key:"narrow",value:function(){return!1}},{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"names",value:void 0},{kind:"field",decorators:[(0,b.MZ)()],key:"unit",value:void 0},{kind:"field",decorators:[(0,b.MZ)()],key:"identifier",value:void 0},{kind:"field",decorators:[(0,b.MZ)({type:Boolean})],key:"showNames",value:function(){return!0}},{kind:"field",decorators:[(0,b.MZ)({type:Boolean})],key:"clickForMoreInfo",value:function(){return!0}},{kind:"field",decorators:[(0,b.MZ)({type:Boolean})],key:"chunked",value:function(){return!1}},{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,b.MZ)({type:Number})],key:"paddingYAxis",value:function(){return 0}},{kind:"field",decorators:[(0,b.MZ)({type:Number})],key:"chartIndex",value:void 0},{kind:"field",decorators:[(0,b.wk)()],key:"_chartData",value:void 0},{kind:"field",decorators:[(0,b.wk)()],key:"_chartOptions",value:void 0},{kind:"field",decorators:[(0,b.wk)()],key:"_yWidth",value:function(){return 0}},{kind:"field",key:"_chartTime",value:function(){return new Date}},{kind:"field",decorators:[(0,b.P)("ha-chart-base")],key:"_chart",value:void 0},{kind:"field",key:"resize",value:function(){var t=this;return function(e){var i;null===(i=t._chart)||void 0===i||i.resize(e)}}},{kind:"method",key:"render",value:function(){return(0,g.qy)(I||(I=(0,r.A)([' <ha-chart-base .hass="','" .data="','" .options="','" .height="','" .paddingYAxis="','" chart-type="timeline"></ha-chart-base> '])),this.hass,this._chartData,this._chartOptions,30*this.data.length+30,this.paddingYAxis-this._yWidth)}},{kind:"method",key:"willUpdate",value:function(t){this.hasUpdated||this._createOptions(),(t.has("startTime")||t.has("endTime")||t.has("data")||this._chartTime<new Date(this.endTime.getTime()-D.p))&&this._generateData(),(t.has("startTime")||t.has("endTime")||t.has("showNames"))&&this._createOptions()}},{kind:"method",key:"_createOptions",value:function(){var t=this,e=this.narrow;this._chartOptions={maintainAspectRatio:!1,parsing:!1,animation:!1,scales:{x:{type:"timeline",position:"bottom",adapters:{date:{locale:this.hass.locale,config:this.hass.config}},min:this.startTime,suggestedMax:this.endTime,ticks:{autoSkip:!0,maxRotation:0,sampleSize:5,autoSkipPadding:20,major:{enabled:!0},font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},grid:{offset:!1},time:{tooltipFormat:"datetimeseconds"}},y:{type:"category",barThickness:20,offset:!0,grid:{display:!1,drawBorder:!1,drawTicks:!1},ticks:{display:this.chunked||this.showNames},afterSetDimensions:function(t){t.maxWidth=.18*t.chart.width},afterFit:function(i){t.chunked&&(i.width=e?105:185)},afterUpdate:function(e){var i,a,n=t.showNames?null!==(i=e.width)&&void 0!==i?i:0:(0,M.qC)(t.hass)?0:null!==(a=e.left)&&void 0!==a?a:0;t._yWidth!==Math.floor(n)&&e.ticks.length===t.data.length&&(t._yWidth=Math.floor(n),(0,T.r)(t,"y-width-changed",{value:t._yWidth,chartIndex:t.chartIndex}))},position:(0,M.qC)(this.hass)?"right":"left"}},plugins:{tooltip:{mode:"nearest",callbacks:{title:function(t){return t[0].chart.data.labels[t[0].datasetIndex]},beforeBody:function(t){return t[0].dataset.label||""},label:function(e){var i=e.dataset.data[e.dataIndex],a=i.end.getTime()-i.start.getTime(),n="".concat(t.hass.localize("ui.components.history_charts.duration"),": ").concat((0,w.A)(a));return[i.label||"",(0,x.yg)(i.start,t.hass.locale,t.hass.config),(0,x.yg)(i.end,t.hass.locale,t.hass.config),n]},labelColor:function(t){return{borderColor:t.dataset.data[t.dataIndex].color,backgroundColor:t.dataset.data[t.dataIndex].color}}}},filler:{propagate:!0}},locale:(0,A.Yf)(this.hass.locale),onClick:function(e){var i;if(t.clickForMoreInfo&&!(0,Y.a)(e)){var a=e.chart,n=(0,_.gP)(e,a),r=Math.abs(a.scales.y.getValueForPixel(n.y));(0,T.r)(t,"hass-more-info",{entityId:null===(i=t._chartData)||void 0===i||null===(i=i.datasets[r])||void 0===i?void 0:i.label}),a.canvas.dispatchEvent(new Event("mouseout"))}}}}},{kind:"method",key:"_generateData",value:function(){var t=this,e=getComputedStyle(this),i=this.data;i||(i=[]),this._chartTime=new Date;var a=this.startTime,n=this.endTime,r=[],s=[],o=this.names||{};i.forEach((function(i){var c,u=null,l=null,d=a,h=o[i.entity_id]||i.name,f=[];i.data.forEach((function(a){var r=a.state;r||(r=null),new Date(a.last_changed)>n||(null===u?(u=r,l=a.state_localize,d=new Date(a.last_changed)):r!==u&&(c=new Date(a.last_changed),f.push({start:d,end:c,label:l,color:(0,Z.c)(u,e,t.hass.states[i.entity_id])}),u=r,l=a.state_localize,d=c))})),null!==u&&f.push({start:d,end:n,label:l,color:(0,Z.c)(u,e,t.hass.states[i.entity_id])}),s.push({data:f,label:i.entity_id}),r.push(h)})),this._chartData={labels:r,datasets:s}}},{kind:"get",static:!0,key:"styles",value:function(){return(0,g.AH)(W||(W=(0,r.A)(["ha-chart-base{--chart-max-height:none}"])))}}]}}),g.WF),a(),t.next=54;break;case 51:t.prev=51,t.t2=t.catch(0),a(t.t2);case 54:case"end":return t.stop()}}),t,null,[[0,51]])})));return function(e,i){return t.apply(this,arguments)}}())},4159:function(t,e,i){var a=i(22858).A,n=i(33994).A;i.a(t,function(){var t=a(n().mark((function t(e,a){var r,s,o,c,u,l,d,h,f,m,v,y,p,k,_,g,b,x,w,T,A,M,D,Z,Y,z,S,I,W,O,j,E,C,F,H,N,P,B,q,U,V,R;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=i(41981),s=i(64599),o=i(35806),c=i(71008),u=i(62193),l=i(2816),d=i(27927),h=i(81027),f=i(82386),m=i(95737),v=i(97741),y=i(89655),p=i(46469),k=i(29193),_=i(39790),g=i(9241),b=i(36604),x=i(253),w=i(54846),T=i(16891),A=i(37679),M=i(4525),D=i(66555),Z=i(96858),Y=i(15112),z=i(29818),S=i(33922),I=i(37456),W=i(28884),O=i(64351),j=i(26478),!(E=e([O,j])).then){t.next=57;break}return t.next=53,E;case 53:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=58;break;case 57:t.t0=E;case 58:C=t.t0,O=C[0],j=C[1],R=function(t,e){return t.reduce((function(t,i,a){var n=Math.floor(a/e);return t[n]||(t[n]=[]),t[n].push(i),t}),[])},(0,d.A)([(0,z.EM)("state-history-charts")],(function(t,e){var i=function(e){function i(){var e;(0,c.A)(this,i);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return e=(0,u.A)(this,i,[].concat(n)),t(e),e}return(0,l.A)(i,e),(0,o.A)(i)}(e);return{F:i,d:[{kind:"field",decorators:[(0,z.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,z.MZ)({attribute:!1})],key:"historyData",value:void 0},{kind:"field",decorators:[(0,z.MZ)({type:Boolean})],key:"narrow",value:function(){return!1}},{kind:"field",decorators:[(0,z.MZ)({attribute:!1})],key:"names",value:void 0},{kind:"field",decorators:[(0,z.MZ)({type:Boolean,reflect:!0})],key:"virtualize",value:function(){return!1}},{kind:"field",decorators:[(0,z.MZ)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,z.MZ)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,z.MZ)({type:Boolean,attribute:"up-to-now"})],key:"upToNow",value:function(){return!1}},{kind:"field",decorators:[(0,z.MZ)({type:Number})],key:"hoursToShow",value:void 0},{kind:"field",decorators:[(0,z.MZ)({type:Boolean})],key:"showNames",value:function(){return!0}},{kind:"field",decorators:[(0,z.MZ)({type:Boolean})],key:"clickForMoreInfo",value:function(){return!0}},{kind:"field",decorators:[(0,z.MZ)({type:Boolean})],key:"isLoadingData",value:function(){return!1}},{kind:"field",decorators:[(0,z.MZ)({type:Boolean})],key:"logarithmicScale",value:function(){return!1}},{kind:"field",decorators:[(0,z.MZ)({type:Number})],key:"minYAxis",value:void 0},{kind:"field",decorators:[(0,z.MZ)({type:Number})],key:"maxYAxis",value:void 0},{kind:"field",decorators:[(0,z.MZ)({type:Boolean})],key:"fitYData",value:function(){return!1}},{kind:"field",key:"_computedStartTime",value:void 0},{kind:"field",key:"_computedEndTime",value:void 0},{kind:"field",decorators:[(0,z.wk)()],key:"_maxYWidth",value:function(){return 0}},{kind:"field",decorators:[(0,z.wk)()],key:"_childYWidths",value:function(){return[]}},{kind:"field",decorators:[(0,z.wk)()],key:"_chartCount",value:function(){return 0}},{kind:"field",decorators:[(0,I.a)(".container")],key:"_savedScrollPos",value:void 0},{kind:"field",decorators:[(0,z.YG)("state-history-chart-line")],key:"_charts",value:void 0},{kind:"field",key:"resize",value:function(){var t=this;return function(e){var i;null===(i=t._charts)||void 0===i||i.forEach((function(t){return t.resize(e)}))}}},{kind:"method",key:"render",value:function(){var t=this;if(!(0,S.x)(this.hass,"history"))return(0,Y.qy)(F||(F=(0,s.A)(['<div class="info"> '," </div>"])),this.hass.localize("ui.components.history_charts.history_disabled"));if(this.isLoadingData&&!this.historyData)return(0,Y.qy)(H||(H=(0,s.A)(['<div class="info"> '," </div>"])),this.hass.localize("ui.components.history_charts.loading_history"));if(this._isHistoryEmpty())return(0,Y.qy)(N||(N=(0,s.A)(['<div class="info"> '," </div>"])),this.hass.localize("ui.components.history_charts.no_history_found"));var e=this.historyData.timeline.length?(this.virtualize?R(this.historyData.timeline,10):[this.historyData.timeline]).concat(this.historyData.line):this.historyData.line;return this._chartCount=e.length,this.virtualize?(0,Y.qy)(P||(P=(0,s.A)(['<div class="container ha-scrollbar" @scroll="','"> <lit-virtualizer scroller class="ha-scrollbar" .items="','" .renderItem="','"> </lit-virtualizer> </div>'])),this._saveScrollPos,e,this._renderHistoryItem):(0,Y.qy)(B||(B=(0,s.A)(["",""])),e.map((function(e,i){return t._renderHistoryItem(e,i)})))}},{kind:"field",key:"_renderHistoryItem",value:function(){var t=this;return function(e,i){return e&&void 0!==i?Array.isArray(e)?(0,Y.qy)(U||(U=(0,s.A)(['<div class="entry-container"> <state-history-chart-timeline .hass="','" .data="','" .startTime="','" .endTime="','" .showNames="','" .names="','" .narrow="','" .chunked="','" .paddingYAxis="','" .chartIndex="','" .clickForMoreInfo="','" @y-width-changed="','"></state-history-chart-timeline> </div> '])),t.hass,e,t._computedStartTime,t._computedEndTime,t.showNames,t.names,t.narrow,t.virtualize,t._maxYWidth,i,t.clickForMoreInfo,t._yWidthChanged):(0,Y.qy)(q||(q=(0,s.A)(['<div class="entry-container"> <state-history-chart-line .hass="','" .unit="','" .data="','" .identifier="','" .showNames="','" .startTime="','" .endTime="','" .paddingYAxis="','" .names="','" .chartIndex="','" .clickForMoreInfo="','" .logarithmicScale="','" .minYAxis="','" .maxYAxis="','" .fitYData="','" @y-width-changed="','"></state-history-chart-line> </div> '])),t.hass,e.unit,e.data,e.identifier,t.showNames,t._computedStartTime,t._computedEndTime,t._maxYWidth,t.names,i,t.clickForMoreInfo,t.logarithmicScale,t.minYAxis,t.maxYAxis,t.fitYData,t._yWidthChanged):Y.s6}}},{kind:"method",key:"shouldUpdate",value:function(t){return(1!==t.size||!t.has("hass"))&&(1!==t.size||!t.has("_maxYWidth")||t.get("_maxYWidth")!==this._maxYWidth)}},{kind:"method",key:"willUpdate",value:function(t){if(this.hasUpdated||(0,W.i)(),(0,r.A)(t.keys()).some((function(t){return!["_maxYWidth","_childYWidths","_chartCount"].includes(t)}))){var e=new Date;if(this._computedEndTime=this.upToNow||!this.endTime||this.endTime>e?e:this.endTime,this.startTime)this._computedStartTime=this.startTime;else if(this.hoursToShow)this._computedStartTime=new Date((new Date).getTime()-3600*this.hoursToShow*1e3);else{var i,a,n,s,o=(null!==(i=null===(a=this.historyData)||void 0===a?void 0:a.timeline)&&void 0!==i?i:[]).reduce((function(t,e){return Math.min(t,new Date(e.data[0].last_changed).getTime())}),(new Date).getTime());o=(null!==(n=null===(s=this.historyData)||void 0===s?void 0:s.line)&&void 0!==n?n:[]).reduce((function(t,e){return Math.min(t,e.data.reduce((function(t,e){return Math.min(t,new Date(e.states[0].last_changed).getTime())}),t))}),o),this._computedStartTime=new Date(o)}}}},{kind:"method",key:"updated",value:function(t){t.has("_chartCount")&&this._chartCount<this._childYWidths.length&&(this._childYWidths.length=this._chartCount,this._maxYWidth=Math.max.apply(Math,(0,r.A)(Object.values(this._childYWidths)).concat([0])))}},{kind:"method",key:"_yWidthChanged",value:function(t){this._childYWidths[t.detail.chartIndex]=t.detail.value,this._maxYWidth=Math.max.apply(Math,(0,r.A)(Object.values(this._childYWidths)).concat([0]))}},{kind:"method",key:"_isHistoryEmpty",value:function(){var t=!this.historyData||!this.historyData.timeline||!this.historyData.line||0===this.historyData.timeline.length&&0===this.historyData.line.length;return!this.isLoadingData&&t}},{kind:"method",decorators:[(0,z.Ls)({passive:!0})],key:"_saveScrollPos",value:function(t){this._savedScrollPos=t.target.scrollTop}},{kind:"get",static:!0,key:"styles",value:function(){return(0,Y.AH)(V||(V=(0,s.A)([":host{display:block;min-height:60px}:host([virtualize]){height:100%}.info{text-align:center;line-height:60px;color:var(--secondary-text-color)}.container{max-height:var(--history-max-height)}.entry-container{width:100%}.entry-container:hover{z-index:1}:host([virtualize]) .entry-container{padding-left:1px;padding-right:1px;padding-inline-start:1px;padding-inline-end:1px}.entry-container:not(:first-child){border-top:2px solid var(--divider-color);margin-top:16px}.container,lit-virtualizer{height:100%;width:100%}lit-virtualizer{contain:size layout!important}state-history-chart-line,state-history-chart-timeline{width:100%}"])))}}]}}),Y.WF),a(),t.next=70;break;case 67:t.prev=67,t.t2=t.catch(0),a(t.t2);case 70:case"end":return t.stop()}}),t,null,[[0,67]])})));return function(e,i){return t.apply(this,arguments)}}())},11630:function(t,e,i){var a=i(22858).A,n=i(33994).A;i.a(t,function(){var t=a(n().mark((function t(a,r){var s,o,c,u,l,d,h,f,m,v,y,p,k,_,g,b,x,w,T,A,M,D,Z,Y,z,S,I,W,O,j,E,C,F,H,N,P,B,q,U,V,R,L,Q,G,J,K,X,$,tt,et,it,at,nt,rt,st;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i.d(e,{IQ:function(){return K},Jo:function(){return G},Mm:function(){return rt},qc:function(){return st}}),s=i(41981),o=i(64782),c=i(71008),u=i(35806),l=i(81027),d=i(13025),h=i(44124),f=i(82386),m=i(95737),v=i(79243),y=i(97741),p=i(89655),k=i(33231),_=i(54774),g=i(26098),b=i(10507),x=i(39790),w=i(74268),T=i(24545),A=i(51855),M=i(82130),D=i(31743),Z=i(22328),Y=i(4959),z=i(62435),S=i(36604),I=i(99019),W=i(253),O=i(2075),j=i(94438),E=i(54846),C=i(16891),F=i(4525),H=i(66555),N=i(96858),P=i(213),B=i(64741),q=i(19244),!(U=a([B])).then){t.next=79;break}return t.next=75,U;case 75:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=80;break;case 79:t.t0=U;case 80:B=t.t0[0],V=["climate","humidifier","water_heater"],R=["climate","humidifier","input_datetime","thermostat","water_heater","person","device_tracker"],L=["temperature","current_temperature","target_temp_low","target_temp_high","hvac_action","humidity","mode","action","current_humidity"],Q=function(t,e){return!t.states[e]||R.includes((0,P.m)(e))},G=function(t,e,i,a,n){var r={type:"history/stream",entity_ids:n,start_time:i.toISOString(),end_time:a.toISOString(),minimal_response:!0,no_attributes:!n.some((function(e){return Q(t,e)}))},s=new J(t);return t.connection.subscribeMessage((function(t){return e(s.processMessage(t))}),r)},J=function(){return(0,u.A)((function t(e,i){(0,c.A)(this,t),this.hass=void 0,this.hoursToShow=void 0,this.combinedHistory=void 0,this.hass=e,this.hoursToShow=i,this.combinedHistory={}}),[{key:"processMessage",value:function(t){if(!this.combinedHistory||!Object.keys(this.combinedHistory).length)return this.combinedHistory=t.states,this.combinedHistory;if(!Object.keys(t.states).length)return this.combinedHistory;for(var e=this.hoursToShow?((new Date).getTime()-3600*this.hoursToShow*1e3)/1e3:void 0,i={},a=0,n=Object.keys(this.combinedHistory);a<n.length;a++){i[n[a]]=[]}for(var r=0,s=Object.keys(t.states);r<s.length;r++){i[s[r]]=[]}for(var o=0,c=Object.keys(i);o<c.length;o++){var u=c[o];if(u in this.combinedHistory&&u in t.states){var l=this.combinedHistory[u],d=l[l.length-1];i[u]=l.concat(t.states[u]),t.states[u][0].lu<d.lu&&(i[u]=i[u].sort((function(t,e){return t.lu-e.lu})))}else u in this.combinedHistory?i[u]=this.combinedHistory[u]:i[u]=t.states[u];if(e&&u in this.combinedHistory){var h=i[u].filter((function(t){return t.lu<e}));if(!h.length)continue;if(i[u]=i[u].filter((function(t){return t.lu>=e})),i[u].length&&i[u][0].lu===e)continue;var f=h[h.length-1];f.lu=e,i[u].unshift(f)}}return this.combinedHistory=i,this.combinedHistory}}])}(),K=function(t,e,i,a){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6?arguments[6]:void 0,o={type:"history/stream",entity_ids:a,start_time:new Date((new Date).getTime()-3600*i*1e3).toISOString(),minimal_response:n,significant_changes_only:r,no_attributes:null!=s?s:!a.some((function(e){return Q(t,e)}))},c=new J(t,i);return t.connection.subscribeMessage((function(t){return e(c.processMessage(t))}),o)},X=function(t,e){return t.state===e.state&&(!t.attributes||!e.attributes||L.every((function(i){return t.attributes[i]===e.attributes[i]})))},$=function(t,e,i,a,n,r,s){var c,u=[],l=r[0],d=(0,o.A)(r);try{for(d.s();!(c=d.n()).done;){var h=c.value;if(!(u.length>0&&h.s===u[u.length-1].state)){var f={};null!=s&&s.attributes.device_class&&(f.device_class=null==s?void 0:s.attributes.device_class),u.push({state_localize:(0,B.computeStateDisplayFromEntityAttributes)(t,e,[],i,a[n],n,Object.assign(Object.assign({},h.a||l.a),f),h.s),state:h.s,last_changed:1e3*(h.lc?h.lc:h.lu)})}}}catch(m){d.e(m)}finally{d.f()}return{name:(0,q._)(n,(null==s?void 0:s.attributes)||l.a),entity_id:n,data:u}},tt=function(t,e,i,a){var n=[];return Object.keys(i).forEach((function(t){var e,r=i[t],s=r[0],c=(0,P.m)(t),u=[],l=(0,o.A)(r);try{for(l.s();!(e=l.n()).done;){var d=e.value,h=void 0;if(V.includes(c)){h={state:d.s,last_changed:1e3*d.lu,attributes:{}};for(var f=0,m=L;f<m.length;f++){var v=m[f];v in d.a&&(h.attributes[v]=d.a[v])}}else h={state:d.s,last_changed:1e3*(d.lc?d.lc:d.lu),attributes:{}};u.length>1&&X(h,u[u.length-1])&&X(h,u[u.length-2])||u.push(h)}}catch(p){l.e(p)}finally{l.f()}var y=t in a?a[t].attributes:"friendly_name"in s.a?s.a:void 0;n.push({domain:c,name:(0,q._)(t,y||{}),entity_id:t,states:u})})),{unit:t,device_class:e,identifier:Object.keys(i).join(""),data:n}},et=["counter","input_number","number"],it=function(t){return et.includes(t)},at=function(t){return"unit_of_measurement"in t||"state_class"in t},nt=function(t,e){return null!=t.attributes.device_class&&e.includes(t.attributes.device_class)},rt=function(t,e,i,a,n){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c={},u=[],l={};return new Set([].concat((0,s.A)(i),(0,s.A)(Object.keys(e)))).forEach((function(i){i in e?l[i]=e[i]:t.states[i]&&(l[i]=[{s:t.states[i].state,a:t.states[i].attributes,lu:new Date(t.states[i].last_updated).getTime()/1e3}])})),l?(Object.keys(l).forEach((function(e){var i,d=l[e];if(0!==d.length){var h,f=(0,P.m)(e),m=e in t.states?t.states[e]:void 0,v=m||it(f)?void 0:d.find((function(t){return t.a&&at(t.a)}));h=o||it(f)||null!=m&&at(m.attributes)||null!=m&&"sensor"===f&&nt(m,n)||null!=v?(null==m?void 0:m.attributes.unit_of_measurement)||(null==v?void 0:v.a.unit_of_measurement)||" ":{zone:a("ui.dialogs.more_info_control.zone.graph_unit"),climate:t.config.unit_system.temperature,humidifier:"%",water_heater:t.config.unit_system.temperature}[f];var y={climate:"temperature",humidifier:"humidity",water_heater:"temperature"}[f]||(null===(i=(null==m?void 0:m.attributes)||(null==v?void 0:v.a))||void 0===i?void 0:i.device_class),p=st(h,y,r);if(h)if(p&&p in c&&e in c[p]){var k;(k=c[p][e]).push.apply(k,(0,s.A)(d))}else p&&(p in c||(c[p]={}),c[p][e]=d);else u.push($(a,t.locale,t.config,t.entities,e,d,m))}})),{line:Object.keys(c).map((function(e){var i=e.split("_"),a=i[0],n=i[1]||void 0;return tt(a,n,c[e],t.states)})),timeline:u}):{line:[],timeline:[]}},st=function(t,e,i){return i?"".concat(t,"_").concat(e||""):t},r(),t.next=105;break;case 102:t.prev=102,t.t2=t.catch(0),r(t.t2);case 105:case"end":return t.stop()}}),t,null,[[0,102]])})));return function(e,i){return t.apply(this,arguments)}}())},28884:function(t,e,i){i.d(e,{i:function(){return r}});var a=i(33994),n=i(22858),r=(i(95737),i(39790),i(66457),i(99019),i(96858),function(){var t=(0,n.A)((0,a.A)().mark((function t(){return(0,a.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([i.e(70014),i.e(34597)]).then(i.bind(i,70014));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}())}}]);
//# sourceMappingURL=81140.6gcu0ciweAI.js.map