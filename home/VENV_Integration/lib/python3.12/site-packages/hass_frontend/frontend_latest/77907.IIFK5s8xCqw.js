export const id=77907;export const ids=[77907];export const modules={21863:(e,i,t)=>{function r(e){return void 0===e||Array.isArray(e)?e:[e]}t.d(i,{e:()=>r})},99890:(e,i,t)=>{t.d(i,{g:()=>r});const r=e=>(i,t)=>e.includes(i,t)},81771:(e,i,t)=>{t.d(i,{$W:()=>p,Dp:()=>b,EC:()=>a,HB:()=>m,S9:()=>k,XF:()=>l,aI:()=>h,b1:()=>_,bV:()=>c,lB:()=>d,lg:()=>u,mX:()=>q,oj:()=>g,rY:()=>j,vH:()=>Y,vO:()=>v});t(89655),t(253),t(54846),t(16891);var r=t(16312),n=t(21863),s=t(55979),o=t(56932);const a="single",c=10,l=e=>{if("condition"in e&&Array.isArray(e.condition))return{condition:"and",conditions:e.condition};for(const i of["and","or","not"])if(i in e)return{condition:i,conditions:e[i]};return e},d=(e,i)=>{e.callService("automation","trigger",{entity_id:i,skip_condition:!0})},u=(e,i)=>e.callApi("DELETE",`config/automation/config/${i}`);let f;const g=(e,i)=>e.callApi("GET",`config/automation/config/${i}`),p=(e,i)=>e.callWS({type:"automation/config",entity_id:i}),_=(e,i,t)=>e.callApi("POST",`config/automation/config/${i}`,t),m=e=>{e=y(e);for(const i of["triggers","conditions","actions"]){const t=e[i];t&&!Array.isArray(t)&&(e[i]=[t])}return e},y=e=>("trigger"in e&&("triggers"in e||(e.triggers=e.trigger),delete e.trigger),"condition"in e&&("conditions"in e||(e.conditions=e.condition),delete e.condition),"action"in e&&("actions"in e||(e.actions=e.action),delete e.action),e.triggers&&(e.triggers=v(e.triggers)),e.actions&&(e.actions=(0,s.Rn)(e.actions)),e),v=e=>Array.isArray(e)?e.map(v):("triggers"in e&&e.triggers&&(e.triggers=v(e.triggers)),"platform"in e&&("trigger"in e||(e.trigger=e.platform),delete e.platform),e),h=e=>{if(!e)return[];const i=[];return(0,n.e)(e).forEach((e=>{"triggers"in e?e.triggers&&i.push(...h(e.triggers)):i.push(e)})),i},q=(e,i)=>{f=e;const t=i?`?${(0,o.KH)({expanded:"1"})}`:"";(0,r.o)(`/config/automation/edit/new${t}`)},Y=e=>{q({...e,id:void 0,alias:void 0})},j=()=>{const e=f;return f=void 0,e},b=(e,i,t,r)=>e.connection.subscribeMessage(i,{type:"subscribe_trigger",trigger:t,variables:r}),k=(e,i,t)=>e.callWS({type:"test_condition",condition:i,variables:t})},55979:(e,i,t)=>{t.d(i,{AM:()=>j,BD:()=>g,FN:()=>l,Ht:()=>v,Iq:()=>d,Kq:()=>q,NX:()=>b,Q2:()=>y,R$:()=>Y,Rn:()=>w,TP:()=>A,kR:()=>m,pq:()=>k});t(16891);var r=t(66419),n=t(99890),s=t(16312),o=t(81771),a=t(59780),c=t(56932);const l=["single","restart","queued","parallel"],d=(0,n.g)(["queued","parallel"]),u=(0,r.Ik)({alias:(0,r.lq)((0,r.Yj)()),continue_on_error:(0,r.lq)((0,r.zM)()),enabled:(0,r.lq)((0,r.zM)())}),f=(0,r.Ik)({entity_id:(0,r.lq)((0,r.KC)([(0,r.Yj)(),(0,r.YO)((0,r.Yj)())])),device_id:(0,r.lq)((0,r.KC)([(0,r.Yj)(),(0,r.YO)((0,r.Yj)())])),area_id:(0,r.lq)((0,r.KC)([(0,r.Yj)(),(0,r.YO)((0,r.Yj)())])),floor_id:(0,r.lq)((0,r.KC)([(0,r.Yj)(),(0,r.YO)((0,r.Yj)())])),label_id:(0,r.lq)((0,r.KC)([(0,r.Yj)(),(0,r.YO)((0,r.Yj)())]))}),g=(0,r.kp)(u,(0,r.Ik)({action:(0,r.lq)((0,r.Yj)()),service_template:(0,r.lq)((0,r.Yj)()),entity_id:(0,r.lq)((0,r.Yj)()),target:(0,r.lq)(f),data:(0,r.lq)((0,r.Ik)()),response_variable:(0,r.lq)((0,r.Yj)()),metadata:(0,r.lq)((0,r.Ik)())})),p=(0,r.kp)(u,(0,r.Ik)({action:(0,r.eu)("media_player.play_media"),target:(0,r.lq)((0,r.Ik)({entity_id:(0,r.lq)((0,r.Yj)())})),entity_id:(0,r.lq)((0,r.Yj)()),data:(0,r.Ik)({media_content_id:(0,r.Yj)(),media_content_type:(0,r.Yj)()}),metadata:(0,r.Ik)()})),_=(0,r.kp)(u,(0,r.Ik)({action:(0,r.eu)("scene.turn_on"),target:(0,r.lq)((0,r.Ik)({entity_id:(0,r.lq)((0,r.Yj)())})),entity_id:(0,r.lq)((0,r.Yj)()),metadata:(0,r.Ik)()})),m=(e,i,t)=>e.callService("script",i,t),y=e=>"off"===e.state||!!("on"===e.state&&d(e.attributes.mode)&&e.attributes.current<e.attributes.max),v=(e,i)=>e.callApi("DELETE",`config/script/config/${i}`);let h;const q=(e,i)=>e.callApi("GET",`config/script/config/${i}`),Y=(e,i)=>e.callWS({type:"script/config",entity_id:i}),j=(e,i)=>{h=e;const t=i?`?${(0,c.KH)({expanded:"1"})}`:"";(0,s.o)(`/config/script/edit/new${t}`)},b=()=>{const e=h;return h=void 0,e},k=e=>{if("delay"in e)return"delay";if("wait_template"in e)return"wait_template";if(["condition","and","or","not"].some((i=>i in e)))return"check_condition";if("event"in e)return"fire_event";if("device_id"in e)return"device_action";if("scene"in e)return"activate_scene";if("repeat"in e)return"repeat";if("choose"in e)return"choose";if("if"in e)return"if";if("wait_for_trigger"in e)return"wait_for_trigger";if("variables"in e)return"variables";if("stop"in e)return"stop";if("sequence"in e)return"sequence";if("parallel"in e)return"parallel";if("set_conversation_response"in e)return"set_conversation_response";if("action"in e||"service"in e){if("metadata"in e){if((0,r.is)(e,_))return"activate_scene";if((0,r.is)(e,p))return"play_media"}return"service"}return"unknown"},A=(e,i)=>{const t=e.services.script[(0,a.Y)(i)]?.fields;return void 0!==t&&Object.keys(t).length>0},w=e=>{if(Array.isArray(e))return e.map(w);if("service"in e&&("action"in e||(e.action=e.service),delete e.service),"sequence"in e)for(const i of e.sequence)w(i);const i=k(e);if("parallel"===i){w(e.parallel)}if("choose"===i){const i=e;if(Array.isArray(i.choose))for(const e of i.choose)w(e.sequence);else i.choose&&w(i.choose.sequence);i.default&&w(i.default)}if("repeat"===i){w(e.repeat.sequence)}if("if"===i){const i=e;w(i.then),i.else&&w(i.else)}if("wait_for_trigger"===i){const i=e;(0,o.vO)(i.wait_for_trigger)}return e}},77907:(e,i,t)=>{t.r(i),t.d(i,{addExternalBarCodeListener:()=>c,attachExternalToApp:()=>a});t(24545),t(51855),t(82130),t(31743),t(22328),t(4959),t(62435),t(253),t(54846);var r=t(34897),n=t(74005),s=t(81771);const o=new Set,a=e=>{window.addEventListener("haptic",(i=>e.hass.auth.external.fireMessage({type:"haptic",payload:{hapticType:i.detail}}))),e.hass.auth.external.addCommandHandler((i=>l(e,i)))},c=e=>(o.add(e),()=>{o.delete(e)}),l=(e,i)=>{const t=e.hass.auth.external;if("restart"===i.command)e.hass.connection.reconnect(!0),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else if("notifications/show"===i.command)(0,r.r)(e,"hass-show-notifications"),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else if("sidebar/toggle"===i.command){if(n.G.history.state?.open)return t.fireMessage({id:i.id,type:"result",success:!1,error:{code:"not_allowed",message:"dialog open"}}),!0;(0,r.r)(e,"hass-toggle-menu"),t.fireMessage({id:i.id,type:"result",success:!0,result:null})}else if("sidebar/show"===i.command){if(n.G.history.state?.open)return t.fireMessage({id:i.id,type:"result",success:!1,error:{code:"not_allowed",message:"dialog open"}}),!0;(0,r.r)(e,"hass-toggle-menu",{open:!0}),t.fireMessage({id:i.id,type:"result",success:!0,result:null})}else if("automation/editor/show"===i.command)(0,s.mX)(i.payload?.config),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else if("bar_code/scan_result"===i.command)o.forEach((e=>e(i))),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else{if("bar_code/aborted"!==i.command)return!1;o.forEach((e=>e(i))),t.fireMessage({id:i.id,type:"result",success:!0,result:null})}return!0}}};
//# sourceMappingURL=77907.IIFK5s8xCqw.js.map