export const id=81140;export const ids=[81140];export const modules={37456:(t,e,i)=>{i.d(e,{a:()=>s});const a=(0,i(58034).n)((t=>{history.replaceState({scrollPosition:t},"")}),300),s=t=>e=>({kind:"method",placement:"prototype",key:e.key,descriptor:{set(t){a(t),this[`__${String(e.key)}`]=t},get(){return this[`__${String(e.key)}`]||history.state?.scrollPosition},enumerable:!0,configurable:!0},finisher(i){const a=i.prototype.connectedCallback;i.prototype.connectedCallback=function(){a.call(this);const i=this[e.key];i&&this.updateComplete.then((()=>{const e=this.renderRoot.querySelector(t);e&&setTimeout((()=>{e.scrollTop=i}),0)}))}}})},64741:(t,e,i)=>{i.a(t,(async(t,a)=>{try{i.d(e,{J:()=>p,computeStateDisplay:()=>y});var s=i(9883),n=i(45269),o=i(9449),r=i(57289),d=i(8581),l=i(41924),h=i(57636),c=i(40863),u=i(213),m=t([r,d,l,h]);[r,d,l,h]=m.then?(await m)():m;const y=(t,e,i,a,s,n,o)=>{const r=n?.[e.entity_id];return p(t,i,a,s,r,e.entity_id,e.attributes,void 0!==o?o:e.state)},p=(t,e,i,a,m,y,p,f)=>{if(f===s.HV||f===s.Hh)return t(`state.default.${f}`);const k=(0,u.m)(y);if((0,h.ty)(p,"sensor"===k?i:[])){if("duration"===p.device_class&&p.unit_of_measurement&&o.Z[p.unit_of_measurement])try{return(0,o.a)(f,p.unit_of_measurement)}catch(t){}if("monetary"===p.device_class)try{return(0,h.ZV)(f,e,{style:"currency",currency:p.unit_of_measurement,minimumFractionDigits:2,...(0,h.ZQ)({state:f,attributes:p},m)})}catch(t){}const t=(0,h.ZV)(f,e,(0,h.ZQ)({state:f,attributes:p},m)),i=p.unit_of_measurement;return i?`${t}${(0,c.A)(i,e)}${i}`:t}if("datetime"===k){const t=new Date(f);return(0,d.r6)(t,e,a)}if(["date","input_datetime","time"].includes(k))try{const t=f.split(" ");if(2===t.length)return(0,d.r6)(new Date(t.join("T")),{...e,time_zone:n.Wj.local},a);if(1===t.length){if(f.includes("-"))return(0,r.Yq)(new Date(`${f}T00:00`),{...e,time_zone:n.Wj.local},a);if(f.includes(":")){const t=new Date;return(0,l.fU)(new Date(`${t.toISOString().split("T")[0]}T${f}`),{...e,time_zone:n.Wj.local},a)}}return f}catch(t){return f}if("counter"===k||"number"===k||"input_number"===k)return(0,h.ZV)(f,e,(0,h.ZQ)({state:f,attributes:p},m));if(["button","conversation","event","image","input_button","notify","scene","stt","tag","tts","wake_word"].includes(k)||"sensor"===k&&"timestamp"===p.device_class)try{return(0,d.r6)(new Date(f),e,a)}catch(t){return f}return m?.translation_key&&t(`component.${m.platform}.entity.${k}.${m.translation_key}.state.${f}`)||p.device_class&&t(`component.${k}.entity_component.${p.device_class}.state.${f}`)||t(`component.${k}.entity_component._.state.${f}`)||f};a()}catch(t){a(t)}}))},56136:(t,e,i)=>{i.d(e,{a:()=>a});const a=t=>!(t.native instanceof MouseEvent)||t.native instanceof PointerEvent&&"mouse"!==t.native.pointerType},90701:(t,e,i)=>{i.d(e,{p:()=>u});var a=i(36312),s=i(68689),n=(i(24545),i(51855),i(82130),i(31743),i(22328),i(4959),i(62435),i(253),i(54846),i(16891),i(15112)),o=i(77706),r=i(85323),d=i(63073),l=i(34897),h=i(69678),c=i(18409);const u=3e5;(0,a.A)([(0,o.EM)("ha-chart-base")],(function(t,e){class a extends e{constructor(...e){super(...e),t(this)}}return{F:a,d:[{kind:"field",key:"chart",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:"chart-type",reflect:!0})],key:"chartType",value:()=>"line"},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"data",value:()=>({datasets:[]})},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"extraData",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"options",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"plugins",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Number})],key:"height",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Number})],key:"paddingYAxis",value:()=>0},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"externalHidden",value:()=>!1},{kind:"field",decorators:[(0,o.wk)()],key:"_chartHeight",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_tooltip",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_hiddenDatasets",value:()=>new Set},{kind:"field",key:"_paddingUpdateCount",value:()=>0},{kind:"field",key:"_paddingUpdateLock",value:()=>!1},{kind:"field",key:"_paddingYAxisInternal",value:()=>0},{kind:"field",key:"_datasetOrder",value:()=>[]},{kind:"method",key:"disconnectedCallback",value:function(){(0,s.A)(a,"disconnectedCallback",this,3)([]),this._releaseCanvas()}},{kind:"method",key:"connectedCallback",value:function(){(0,s.A)(a,"connectedCallback",this,3)([]),this.hasUpdated&&(this._releaseCanvas(),this._setupChart())}},{kind:"field",key:"updateChart",value(){return t=>{this.chart?.update(t)}}},{kind:"field",key:"resize",value(){return t=>{t?.aspectRatio&&!t.height?t.height=Math.round((t.width??this.clientWidth)/t.aspectRatio):t?.aspectRatio&&!t.width&&(t.width=Math.round((t.height??this.clientHeight)*t.aspectRatio)),this.chart?.resize(t?.width??this.clientWidth,t?.height??this.clientHeight)}}},{kind:"method",key:"firstUpdated",value:function(){this._setupChart(),this.data.datasets.forEach(((t,e)=>{t.hidden&&this._hiddenDatasets.add(e)}))}},{kind:"method",key:"shouldUpdate",value:function(t){return!this._paddingUpdateLock||1!==t.size||!t.has("paddingYAxis")}},{kind:"field",key:"_debouncedClearUpdates",value(){return(0,c.s)((()=>{this._paddingUpdateCount=0}),2e3,!1)}},{kind:"method",key:"willUpdate",value:function(t){if((0,s.A)(a,"willUpdate",this,3)([t]),this._paddingUpdateLock||(this._paddingYAxisInternal=this.paddingYAxis,1===t.size&&t.has("paddingYAxis")&&(this._paddingUpdateCount++,this._paddingUpdateCount>300?(this._paddingUpdateLock=!0,console.error("Detected excessive chart padding updates, possibly an infinite loop. Disabling axis padding.")):this._debouncedClearUpdates())),t.has("data")&&(this._datasetOrder=this.data.datasets.map(((t,e)=>e)),this.data?.datasets.some((t=>t.order))&&this._datasetOrder.sort(((t,e)=>(this.data.datasets[t].order||0)-(this.data.datasets[e].order||0))),this.externalHidden&&(this._hiddenDatasets=new Set,this.data?.datasets&&this.data.datasets.forEach(((t,e)=>{t.hidden&&this._hiddenDatasets.add(e)})))),this.hasUpdated&&this.chart){if(t.has("plugins")||t.has("chartType"))return this._releaseCanvas(),void this._setupChart();t.has("data")&&(this._hiddenDatasets.size&&!this.externalHidden&&this.data.datasets.forEach(((t,e)=>{t.hidden=this._hiddenDatasets.has(e)})),this.chart.data=this.data),t.has("options")&&(this.chart.options=this._createOptions()),this.chart.update("none")}}},{kind:"method",key:"render",value:function(){return n.qy` ${!0===this.options?.plugins?.legend?.display?n.qy`<div class="chartLegend"> <ul> ${this._datasetOrder.map((t=>{const e=this.data.datasets[t];return!1===this.extraData?.[t]?.show_legend?n.s6:n.qy`<li .datasetIndex="${t}" @click="${this._legendClick}" class="${(0,r.H)({hidden:this._hiddenDatasets.has(t)})}" .title="${this.extraData?.[t]?.legend_label??e.label}"> <div class="bullet" style="${(0,d.W)({backgroundColor:e.backgroundColor,borderColor:e.borderColor})}"></div> <div class="label"> ${this.extraData?.[t]?.legend_label??e.label} </div> </li>`}))} </ul> </div>`:""} <div class="animationContainer" style="${(0,d.W)({height:`${this.height||this._chartHeight||0}px`,overflow:this._chartHeight?"initial":"hidden"})}"> <div class="chartContainer" style="${(0,d.W)({height:`${this.height??this._chartHeight??this.clientWidth/2}px`,"padding-left":`${this._paddingYAxisInternal}px`,"padding-right":0,"padding-inline-start":`${this._paddingYAxisInternal}px`,"padding-inline-end":0})}"> <canvas></canvas> ${this._tooltip?n.qy`<div class="chartTooltip ${(0,r.H)({[this._tooltip.yAlign]:!0})}" style="${(0,d.W)({top:this._tooltip.top,left:this._tooltip.left})}"> <div class="title">${this._tooltip.title}</div> ${this._tooltip.beforeBody?n.qy`<div class="beforeBody"> ${this._tooltip.beforeBody} </div>`:""} <div> <ul> ${this._tooltip.body.map(((t,e)=>n.qy`<li> <div class="bullet" style="${(0,d.W)({backgroundColor:this._tooltip.labelColors[e].backgroundColor,borderColor:this._tooltip.labelColors[e].borderColor})}"></div> ${t.lines.join("\n")} </li>`))} </ul> </div> ${this._tooltip.footer.length?n.qy`<div class="footer"> ${this._tooltip.footer.map((t=>n.qy`${t}<br>`))} </div>`:""} </div>`:""} </div> </div> `}},{kind:"field",key:"_loading",value:()=>!1},{kind:"method",key:"_setupChart",value:async function(){if(this._loading)return;const t=this.renderRoot.querySelector("canvas").getContext("2d");this._loading=!0;try{const e=(await Promise.all([i.e(20288),i.e(75299),i.e(57536),i.e(21200)]).then(i.bind(i,21200))).Chart,a=getComputedStyle(this);e.defaults.borderColor=a.getPropertyValue("--divider-color"),e.defaults.color=a.getPropertyValue("--secondary-text-color"),e.defaults.font.family=a.getPropertyValue("--mdc-typography-body1-font-family")||a.getPropertyValue("--mdc-typography-font-family")||"Roboto, Noto, sans-serif",this.chart=new e(t,{type:this.chartType,data:this.data,options:this._createOptions(),plugins:this._createPlugins()})}finally{this._loading=!1}}},{kind:"method",key:"_createOptions",value:function(){return{maintainAspectRatio:!1,...this.options,plugins:{...this.options?.plugins,tooltip:{...this.options?.plugins?.tooltip,enabled:!1,external:t=>this._handleTooltip(t)},legend:{...this.options?.plugins?.legend,display:!1}}}}},{kind:"method",key:"_createPlugins",value:function(){return[...this.plugins||[],{id:"resizeHook",resize:t=>{const e=t.height-(this._chartHeight??0);(!this._chartHeight||e>12||e<-12)&&(this._chartHeight=t.height)},legend:{...this.options?.plugins?.legend,display:!1}}]}},{kind:"method",key:"_legendClick",value:function(t){if(!this.chart)return;const e=t.currentTarget.datasetIndex;this.chart.isDatasetVisible(e)?(this.chart.setDatasetVisibility(e,!1),this._hiddenDatasets.add(e),this.externalHidden&&(0,l.r)(this,"dataset-hidden",{index:e})):(this.chart.setDatasetVisibility(e,!0),this._hiddenDatasets.delete(e),this.externalHidden&&(0,l.r)(this,"dataset-unhidden",{index:e})),this.chart.update("none"),this.requestUpdate("_hiddenDatasets")}},{kind:"method",key:"_handleTooltip",value:function(t){0!==t.tooltip.opacity?this._tooltip={...t.tooltip,top:this.chart.canvas.offsetTop+t.tooltip.caretY+12+"px",left:this.chart.canvas.offsetLeft+(0,h.q)(t.tooltip.caretX,100,this.clientWidth-100-this._paddingYAxisInternal)-100+"px"}:this._tooltip=void 0}},{kind:"method",key:"_releaseCanvas",value:function(){this.chart&&this.chart.destroy()}},{kind:"get",static:!0,key:"styles",value:function(){return n.AH`:host{display:block;position:var(--chart-base-position,relative)}.animationContainer{overflow:hidden;height:0;transition:height .3s cubic-bezier(.4, 0, .2, 1)}canvas{max-height:var(--chart-max-height,400px)}.chartLegend{text-align:center}.chartLegend li{cursor:pointer;display:inline-grid;grid-auto-flow:column;padding:0 8px;box-sizing:border-box;align-items:center;color:var(--secondary-text-color)}.chartLegend .hidden{text-decoration:line-through}.chartLegend .label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.chartLegend .bullet,.chartTooltip .bullet{border-width:1px;border-style:solid;border-radius:50%;display:inline-block;height:16px;margin-right:6px;width:16px;flex-shrink:0;box-sizing:border-box;margin-inline-end:6px;margin-inline-start:initial;direction:var(--direction)}.chartTooltip .bullet{align-self:baseline}.chartTooltip{padding:8px;font-size:90%;position:absolute;background:rgba(80,80,80,.9);color:#fff;border-radius:4px;pointer-events:none;z-index:1;-ms-user-select:none;-webkit-user-select:none;-moz-user-select:none;width:200px;box-sizing:border-box;direction:var(--direction)}.chartLegend ul,.chartTooltip ul{display:inline-block;padding:0 0px;margin:8px 0 0 0;width:100%}.chartTooltip ul{margin:0 4px}.chartTooltip li{display:flex;white-space:pre-line;word-break:break-word;align-items:center;line-height:16px;padding:4px 0}.chartTooltip .title{text-align:center;font-weight:500;word-break:break-word;direction:ltr}.chartTooltip .footer{font-weight:500}.chartTooltip .beforeBody{text-align:center;font-weight:300;word-break:break-all}`}}]}}),n.WF)},64351:(t,e,i)=>{i.a(t,(async(t,e)=>{try{var a=i(36312),s=(i(89655),i(253),i(54846),i(4525),i(15112)),n=i(77706),o=i(46999),r=i(34897),d=i(40368),l=i(57636),h=i(90701),c=i(56136),u=t([l]);l=(u.then?(await u)():u)[0];const m=t=>{const e=parseFloat(t);return isFinite(e)?e:null};let y=(0,a.A)(null,(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"data",value:()=>[]},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"names",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"unit",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"identifier",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"showNames",value:()=>!0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"clickForMoreInfo",value:()=>!0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Number})],key:"paddingYAxis",value:()=>0},{kind:"field",decorators:[(0,n.MZ)({type:Number})],key:"chartIndex",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"logarithmicScale",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Number})],key:"minYAxis",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Number})],key:"maxYAxis",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"fitYData",value:()=>!1},{kind:"field",decorators:[(0,n.wk)()],key:"_chartData",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_entityIds",value:()=>[]},{kind:"field",key:"_datasetToDataIndex",value:()=>[]},{kind:"field",decorators:[(0,n.wk)()],key:"_chartOptions",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_yWidth",value:()=>0},{kind:"field",key:"_chartTime",value:()=>new Date},{kind:"field",decorators:[(0,n.P)("ha-chart-base")],key:"_chart",value:void 0},{kind:"field",key:"resize",value(){return t=>{this._chart?.resize(t)}}},{kind:"method",key:"render",value:function(){return s.qy` <ha-chart-base .hass="${this.hass}" .data="${this._chartData}" .options="${this._chartOptions}" .paddingYAxis="${this.paddingYAxis-this._yWidth}" chart-type="line"></ha-chart-base> `}},{kind:"method",key:"willUpdate",value:function(t){(!this.hasUpdated||t.has("showNames")||t.has("startTime")||t.has("endTime")||t.has("unit")||t.has("logarithmicScale")||t.has("minYAxis")||t.has("maxYAxis")||t.has("fitYData"))&&(this._chartOptions={parsing:!1,animation:!1,interaction:{mode:"nearest",axis:"xy"},scales:{x:{type:"time",adapters:{date:{locale:this.hass.locale,config:this.hass.config}},min:this.startTime,suggestedMax:this.endTime,ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,major:{enabled:!0},font:t=>t.tick&&t.tick.major?{weight:"bold"}:{}},time:{tooltipFormat:"datetimeseconds"}},y:{suggestedMin:this.fitYData?this.minYAxis:null,suggestedMax:this.fitYData?this.maxYAxis:null,min:this.fitYData?null:this.minYAxis,max:this.fitYData?null:this.maxYAxis,ticks:{maxTicksLimit:7},title:{display:!0,text:this.unit},afterUpdate:t=>{this._yWidth!==Math.floor(t.width)&&(this._yWidth=Math.floor(t.width),(0,r.r)(this,"y-width-changed",{value:this._yWidth,chartIndex:this.chartIndex}))},position:(0,d.qC)(this.hass)?"right":"left",type:this.logarithmicScale?"logarithmic":"linear"}},plugins:{tooltip:{callbacks:{label:t=>{let e=`${t.dataset.label}: ${(0,l.ZV)(t.parsed.y,this.hass.locale,(0,l.ZQ)(void 0,this.hass.entities[this._entityIds[t.datasetIndex]]))} ${this.unit}`;const i=this._datasetToDataIndex[t.datasetIndex],a=this.data[i];if(a.statistics&&a.statistics.length>0){e+=0===a.states.length||t.parsed.x<a.states[0].last_changed?`\n${this.hass.localize("ui.components.history_charts.source_stats")}`:`\n${this.hass.localize("ui.components.history_charts.source_history")}`}return e}}},filler:{propagate:!0},legend:{display:this.showNames,labels:{usePointStyle:!0}}},elements:{line:{tension:.1,borderWidth:1.5},point:{hitRadius:50}},segment:{borderColor:t=>{const e=this._datasetToDataIndex[t.datasetIndex],i=this.data[e];return i.statistics&&i.statistics.length>0&&(0===i.states.length||t.p0.parsed.x<i.states[0].last_changed)?this._chartData.datasets[e].borderColor+"7F":void 0}},locale:(0,l.Yf)(this.hass.locale),onClick:t=>{if(!this.clickForMoreInfo||(0,c.a)(t))return;const e=t.chart,i=e.getElementsAtEventForMode(t,"nearest",{intersect:!0},!0);if(i.length){const t=i[0];(0,r.r)(this,"hass-more-info",{entityId:this._entityIds[t.datasetIndex]}),e.canvas.dispatchEvent(new Event("mouseout"))}}}),(t.has("data")||t.has("startTime")||t.has("endTime")||this._chartTime<new Date(this.endTime.getTime()-h.p))&&this._generateData()}},{kind:"method",key:"_generateData",value:function(){let t=0;const e=getComputedStyle(this),i=this.data,a=[],s=[],n=[];if(0===i.length)return;this._chartTime=new Date;const r=this.endTime,d=this.names||{};i.forEach(((i,l)=>{const h=i.domain,c=d[i.entity_id]||i.name;let u=null;const y=[],p=(t,e)=>{e&&(t>r||(y.forEach(((i,a)=>{null===e[a]&&u&&null!==u[a]&&i.data.push({x:t.getTime(),y:u[a]}),i.data.push({x:t.getTime(),y:e[a]})})),u=e))},f=(a,r=!1,d)=>{d||(d=(0,o.fI)(t,e),t++),y.push({label:a,fill:!!r&&"origin",borderColor:d,backgroundColor:d+"7F",stepped:"before",pointRadius:0,data:[]}),s.push(i.entity_id),n.push(l)};if("thermostat"===h||"climate"===h||"water_heater"===h){const t=i.states.some((t=>t.attributes?.hvac_action)),a="climate"===h&&t?t=>"heating"===t.attributes?.hvac_action:t=>"heat"===t.state,s="climate"===h&&t?t=>"cooling"===t.attributes?.hvac_action:t=>"cool"===t.state,n=i.states.some(a),o=i.states.some(s),r=i.states.some((t=>t.attributes&&t.attributes.target_temp_high!==t.attributes.target_temp_low));f(`${this.hass.localize("ui.card.climate.current_temperature",{name:c})}`),n&&f(`${this.hass.localize("ui.card.climate.heating",{name:c})}`,!0,e.getPropertyValue("--state-climate-heat-color")),o&&f(`${this.hass.localize("ui.card.climate.cooling",{name:c})}`,!0,e.getPropertyValue("--state-climate-cool-color")),r?(f(`${this.hass.localize("ui.card.climate.target_temperature_mode",{name:c,mode:this.hass.localize("ui.card.climate.high")})}`),f(`${this.hass.localize("ui.card.climate.target_temperature_mode",{name:c,mode:this.hass.localize("ui.card.climate.low")})}`)):f(`${this.hass.localize("ui.card.climate.target_temperature_entity",{name:c})}`),i.states.forEach((t=>{if(!t.attributes)return;const e=m(t.attributes.current_temperature),i=[e];if(n&&i.push(a(t)?e:null),o&&i.push(s(t)?e:null),r){const e=m(t.attributes.target_temp_high),a=m(t.attributes.target_temp_low);i.push(e,a),p(new Date(t.last_changed),i)}else{const e=m(t.attributes.temperature);i.push(e),p(new Date(t.last_changed),i)}}))}else if("humidifier"===h){const t=i.states.some((t=>t.attributes?.action)),a=i.states.some((t=>t.attributes?.current_humidity)),s=t&&i.states.some((t=>"humidifying"===t.attributes?.action)),n=t&&i.states.some((t=>"drying"===t.attributes?.action));f(`${this.hass.localize("ui.card.humidifier.target_humidity_entity",{name:c})}`),a&&f(`${this.hass.localize("ui.card.humidifier.current_humidity_entity",{name:c})}`),s?f(`${this.hass.localize("ui.card.humidifier.humidifying",{name:c})}`,!0,e.getPropertyValue("--state-humidifier-on-color")):n?f(`${this.hass.localize("ui.card.humidifier.drying",{name:c})}`,!0,e.getPropertyValue("--state-humidifier-on-color")):f(`${this.hass.localize("ui.card.humidifier.on_entity",{name:c})}`,!0),i.states.forEach((t=>{if(!t.attributes)return;const e=m(t.attributes.humidity),i=a?m(t.attributes?.current_humidity):e,o=[e];a&&o.push(i),s?o.push("humidifying"===t.attributes?.action?i:null):n?o.push("drying"===t.attributes?.action?i:null):o.push("on"===t.state?i:null),p(new Date(t.last_changed),o)}))}else{let t,e;f(c);let a=null;const s=i=>{const s=m(i.state),n=new Date(i.last_changed);if(null!==s&&a){const i=n.getTime(),o=a.getTime(),r=e?.getTime();p(a,[(o-r)/(i-r)*(s-t)+t]),p(new Date(o+1),[null]),p(n,[s]),e=n,t=s,a=null}else null!==s&&null===a?(p(n,[s]),e=n,t=s):null===s&&null===a&&void 0!==t&&(a=n)};if(i.statistics){const t=i.states&&0!==i.states.length?i.states[0].last_changed:0;for(let e=0;e<i.statistics.length&&!(t&&i.statistics[e].last_changed>=t);e++)s(i.statistics[e])}i.states.forEach((t=>{s(t)})),null!==a&&p(a,[null])}p(r,u),Array.prototype.push.apply(a,y)})),this._chartData={datasets:a},this._entityIds=s,this._datasetToDataIndex=n}}]}}),s.WF);customElements.define("state-history-chart-line",y),e()}catch(t){e(t)}}))},26478:(t,e,i)=>{i.a(t,(async(t,e)=>{try{var a=i(36312),s=(i(89655),i(253),i(54846),i(20288)),n=i(15112),o=i(77706),r=i(8581),d=i(37582),l=i(34897),h=i(57636),c=i(40368),u=i(90701),m=i(73207),y=i(56136),p=t([r,h,s]);[r,h,s]=p.then?(await p)():p;(0,a.A)([(0,o.EM)("state-history-chart-timeline")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"data",value:()=>[]},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"narrow",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"names",value:void 0},{kind:"field",decorators:[(0,o.MZ)()],key:"unit",value:void 0},{kind:"field",decorators:[(0,o.MZ)()],key:"identifier",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"showNames",value:()=>!0},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"clickForMoreInfo",value:()=>!0},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"chunked",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Number})],key:"paddingYAxis",value:()=>0},{kind:"field",decorators:[(0,o.MZ)({type:Number})],key:"chartIndex",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_chartData",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_chartOptions",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_yWidth",value:()=>0},{kind:"field",key:"_chartTime",value:()=>new Date},{kind:"field",decorators:[(0,o.P)("ha-chart-base")],key:"_chart",value:void 0},{kind:"field",key:"resize",value(){return t=>{this._chart?.resize(t)}}},{kind:"method",key:"render",value:function(){return n.qy` <ha-chart-base .hass="${this.hass}" .data="${this._chartData}" .options="${this._chartOptions}" .height="${30*this.data.length+30}" .paddingYAxis="${this.paddingYAxis-this._yWidth}" chart-type="timeline"></ha-chart-base> `}},{kind:"method",key:"willUpdate",value:function(t){this.hasUpdated||this._createOptions(),(t.has("startTime")||t.has("endTime")||t.has("data")||this._chartTime<new Date(this.endTime.getTime()-u.p))&&this._generateData(),(t.has("startTime")||t.has("endTime")||t.has("showNames"))&&this._createOptions()}},{kind:"method",key:"_createOptions",value:function(){const t=this.narrow;this._chartOptions={maintainAspectRatio:!1,parsing:!1,animation:!1,scales:{x:{type:"timeline",position:"bottom",adapters:{date:{locale:this.hass.locale,config:this.hass.config}},min:this.startTime,suggestedMax:this.endTime,ticks:{autoSkip:!0,maxRotation:0,sampleSize:5,autoSkipPadding:20,major:{enabled:!0},font:t=>t.tick&&t.tick.major?{weight:"bold"}:{}},grid:{offset:!1},time:{tooltipFormat:"datetimeseconds"}},y:{type:"category",barThickness:20,offset:!0,grid:{display:!1,drawBorder:!1,drawTicks:!1},ticks:{display:this.chunked||this.showNames},afterSetDimensions:t=>{t.maxWidth=.18*t.chart.width},afterFit:e=>{this.chunked&&(e.width=t?105:185)},afterUpdate:t=>{const e=this.showNames?t.width??0:(0,c.qC)(this.hass)?0:t.left??0;this._yWidth!==Math.floor(e)&&t.ticks.length===this.data.length&&(this._yWidth=Math.floor(e),(0,l.r)(this,"y-width-changed",{value:this._yWidth,chartIndex:this.chartIndex}))},position:(0,c.qC)(this.hass)?"right":"left"}},plugins:{tooltip:{mode:"nearest",callbacks:{title:t=>t[0].chart.data.labels[t[0].datasetIndex],beforeBody:t=>t[0].dataset.label||"",label:t=>{const e=t.dataset.data[t.dataIndex],i=e.end.getTime()-e.start.getTime(),a=`${this.hass.localize("ui.components.history_charts.duration")}: ${(0,d.A)(i)}`;return[e.label||"",(0,r.yg)(e.start,this.hass.locale,this.hass.config),(0,r.yg)(e.end,this.hass.locale,this.hass.config),a]},labelColor:t=>({borderColor:t.dataset.data[t.dataIndex].color,backgroundColor:t.dataset.data[t.dataIndex].color})}},filler:{propagate:!0}},locale:(0,h.Yf)(this.hass.locale),onClick:t=>{if(!this.clickForMoreInfo||(0,y.a)(t))return;const e=t.chart,i=(0,s.z)(t,e),a=Math.abs(e.scales.y.getValueForPixel(i.y));(0,l.r)(this,"hass-more-info",{entityId:this._chartData?.datasets[a]?.label}),e.canvas.dispatchEvent(new Event("mouseout"))}}}},{kind:"method",key:"_generateData",value:function(){const t=getComputedStyle(this);let e=this.data;e||(e=[]),this._chartTime=new Date;const i=this.startTime,a=this.endTime,s=[],n=[],o=this.names||{};e.forEach((e=>{let r,d=null,l=null,h=i;const c=o[e.entity_id]||e.name,u=[];e.data.forEach((i=>{let s=i.state;s||(s=null),new Date(i.last_changed)>a||(null===d?(d=s,l=i.state_localize,h=new Date(i.last_changed)):s!==d&&(r=new Date(i.last_changed),u.push({start:h,end:r,label:l,color:(0,m.c)(d,t,this.hass.states[e.entity_id])}),d=s,l=i.state_localize,h=r))})),null!==d&&u.push({start:h,end:a,label:l,color:(0,m.c)(d,t,this.hass.states[e.entity_id])}),n.push({data:u,label:e.entity_id}),s.push(c)})),this._chartData={labels:s,datasets:n}}},{kind:"get",static:!0,key:"styles",value:function(){return n.AH`ha-chart-base{--chart-max-height:none}`}}]}}),n.WF);e()}catch(t){e(t)}}))},4159:(t,e,i)=>{i.a(t,(async(t,e)=>{try{var a=i(36312),s=(i(89655),i(253),i(16891),i(37679),i(4525),i(15112)),n=i(77706),o=i(33922),r=i(37456),d=i(28884),l=i(64351),h=i(26478),c=t([l,h]);[l,h]=c.then?(await c)():c;const u=10,m=(t,e)=>t.reduce(((t,i,a)=>{const s=Math.floor(a/e);return t[s]||(t[s]=[]),t[s].push(i),t}),[]);(0,a.A)([(0,n.EM)("state-history-charts")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"historyData",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"narrow",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"names",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,reflect:!0})],key:"virtualize",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"up-to-now"})],key:"upToNow",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Number})],key:"hoursToShow",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"showNames",value:()=>!0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"clickForMoreInfo",value:()=>!0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"isLoadingData",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"logarithmicScale",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Number})],key:"minYAxis",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Number})],key:"maxYAxis",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"fitYData",value:()=>!1},{kind:"field",key:"_computedStartTime",value:void 0},{kind:"field",key:"_computedEndTime",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_maxYWidth",value:()=>0},{kind:"field",decorators:[(0,n.wk)()],key:"_childYWidths",value:()=>[]},{kind:"field",decorators:[(0,n.wk)()],key:"_chartCount",value:()=>0},{kind:"field",decorators:[(0,r.a)(".container")],key:"_savedScrollPos",value:void 0},{kind:"field",decorators:[(0,n.YG)("state-history-chart-line")],key:"_charts",value:void 0},{kind:"field",key:"resize",value(){return t=>{this._charts?.forEach((e=>e.resize(t)))}}},{kind:"method",key:"render",value:function(){if(!(0,o.x)(this.hass,"history"))return s.qy`<div class="info"> ${this.hass.localize("ui.components.history_charts.history_disabled")} </div>`;if(this.isLoadingData&&!this.historyData)return s.qy`<div class="info"> ${this.hass.localize("ui.components.history_charts.loading_history")} </div>`;if(this._isHistoryEmpty())return s.qy`<div class="info"> ${this.hass.localize("ui.components.history_charts.no_history_found")} </div>`;const t=this.historyData.timeline.length?(this.virtualize?m(this.historyData.timeline,u):[this.historyData.timeline]).concat(this.historyData.line):this.historyData.line;return this._chartCount=t.length,this.virtualize?s.qy`<div class="container ha-scrollbar" @scroll="${this._saveScrollPos}"> <lit-virtualizer scroller class="ha-scrollbar" .items="${t}" .renderItem="${this._renderHistoryItem}"> </lit-virtualizer> </div>`:s.qy`${t.map(((t,e)=>this._renderHistoryItem(t,e)))}`}},{kind:"field",key:"_renderHistoryItem",value(){return(t,e)=>t&&void 0!==e?Array.isArray(t)?s.qy`<div class="entry-container"> <state-history-chart-timeline .hass="${this.hass}" .data="${t}" .startTime="${this._computedStartTime}" .endTime="${this._computedEndTime}" .showNames="${this.showNames}" .names="${this.names}" .narrow="${this.narrow}" .chunked="${this.virtualize}" .paddingYAxis="${this._maxYWidth}" .chartIndex="${e}" .clickForMoreInfo="${this.clickForMoreInfo}" @y-width-changed="${this._yWidthChanged}"></state-history-chart-timeline> </div> `:s.qy`<div class="entry-container"> <state-history-chart-line .hass="${this.hass}" .unit="${t.unit}" .data="${t.data}" .identifier="${t.identifier}" .showNames="${this.showNames}" .startTime="${this._computedStartTime}" .endTime="${this._computedEndTime}" .paddingYAxis="${this._maxYWidth}" .names="${this.names}" .chartIndex="${e}" .clickForMoreInfo="${this.clickForMoreInfo}" .logarithmicScale="${this.logarithmicScale}" .minYAxis="${this.minYAxis}" .maxYAxis="${this.maxYAxis}" .fitYData="${this.fitYData}" @y-width-changed="${this._yWidthChanged}"></state-history-chart-line> </div> `:s.s6}},{kind:"method",key:"shouldUpdate",value:function(t){return(1!==t.size||!t.has("hass"))&&(1!==t.size||!t.has("_maxYWidth")||t.get("_maxYWidth")!==this._maxYWidth)}},{kind:"method",key:"willUpdate",value:function(t){if(this.hasUpdated||(0,d.i)(),[...t.keys()].some((t=>!["_maxYWidth","_childYWidths","_chartCount"].includes(t)))){const t=new Date;if(this._computedEndTime=this.upToNow||!this.endTime||this.endTime>t?t:this.endTime,this.startTime)this._computedStartTime=this.startTime;else if(this.hoursToShow)this._computedStartTime=new Date((new Date).getTime()-3600*this.hoursToShow*1e3);else{let t=(this.historyData?.timeline??[]).reduce(((t,e)=>Math.min(t,new Date(e.data[0].last_changed).getTime())),(new Date).getTime());t=(this.historyData?.line??[]).reduce(((t,e)=>Math.min(t,e.data.reduce(((t,e)=>Math.min(t,new Date(e.states[0].last_changed).getTime())),t))),t),this._computedStartTime=new Date(t)}}}},{kind:"method",key:"updated",value:function(t){t.has("_chartCount")&&this._chartCount<this._childYWidths.length&&(this._childYWidths.length=this._chartCount,this._maxYWidth=Math.max(...Object.values(this._childYWidths),0))}},{kind:"method",key:"_yWidthChanged",value:function(t){this._childYWidths[t.detail.chartIndex]=t.detail.value,this._maxYWidth=Math.max(...Object.values(this._childYWidths),0)}},{kind:"method",key:"_isHistoryEmpty",value:function(){const t=!this.historyData||!this.historyData.timeline||!this.historyData.line||0===this.historyData.timeline.length&&0===this.historyData.line.length;return!this.isLoadingData&&t}},{kind:"method",decorators:[(0,n.Ls)({passive:!0})],key:"_saveScrollPos",value:function(t){this._savedScrollPos=t.target.scrollTop}},{kind:"get",static:!0,key:"styles",value:function(){return s.AH`:host{display:block;min-height:60px}:host([virtualize]){height:100%}.info{text-align:center;line-height:60px;color:var(--secondary-text-color)}.container{max-height:var(--history-max-height)}.entry-container{width:100%}.entry-container:hover{z-index:1}:host([virtualize]) .entry-container{padding-left:1px;padding-right:1px;padding-inline-start:1px;padding-inline-end:1px}.entry-container:not(:first-child){border-top:2px solid var(--divider-color);margin-top:16px}.container,lit-virtualizer{height:100%;width:100%}lit-virtualizer{contain:size layout!important}state-history-chart-line,state-history-chart-timeline{width:100%}`}}]}}),s.WF);e()}catch(t){e(t)}}))},11630:(t,e,i)=>{i.a(t,(async(t,a)=>{try{i.d(e,{IQ:()=>y,Jo:()=>u,Mm:()=>w,qc:()=>$});i(89655),i(54774),i(24545),i(51855),i(82130),i(31743),i(22328),i(4959),i(62435),i(253),i(2075),i(94438),i(54846),i(16891),i(4525);var s=i(213),n=i(64741),o=i(19244),r=t([n]);n=(r.then?(await r)():r)[0];const d=["climate","humidifier","water_heater"],l=["climate","humidifier","input_datetime","thermostat","water_heater","person","device_tracker"],h=["temperature","current_temperature","target_temp_low","target_temp_high","hvac_action","humidity","mode","action","current_humidity"],c=(t,e)=>!t.states[e]||l.includes((0,s.m)(e)),u=(t,e,i,a,s)=>{const n={type:"history/stream",entity_ids:s,start_time:i.toISOString(),end_time:a.toISOString(),minimal_response:!0,no_attributes:!s.some((e=>c(t,e)))},o=new m(t);return t.connection.subscribeMessage((t=>e(o.processMessage(t))),n)};class m{constructor(t,e){this.hass=void 0,this.hoursToShow=void 0,this.combinedHistory=void 0,this.hass=t,this.hoursToShow=e,this.combinedHistory={}}processMessage(t){if(!this.combinedHistory||!Object.keys(this.combinedHistory).length)return this.combinedHistory=t.states,this.combinedHistory;if(!Object.keys(t.states).length)return this.combinedHistory;const e=this.hoursToShow?((new Date).getTime()-3600*this.hoursToShow*1e3)/1e3:void 0,i={};for(const t of Object.keys(this.combinedHistory))i[t]=[];for(const e of Object.keys(t.states))i[e]=[];for(const a of Object.keys(i)){if(a in this.combinedHistory&&a in t.states){const e=this.combinedHistory[a],s=e[e.length-1];i[a]=e.concat(t.states[a]),t.states[a][0].lu<s.lu&&(i[a]=i[a].sort(((t,e)=>t.lu-e.lu)))}else a in this.combinedHistory?i[a]=this.combinedHistory[a]:i[a]=t.states[a];if(e&&a in this.combinedHistory){const t=i[a].filter((t=>t.lu<e));if(!t.length)continue;if(i[a]=i[a].filter((t=>t.lu>=e)),i[a].length&&i[a][0].lu===e)continue;const s=t[t.length-1];s.lu=e,i[a].unshift(s)}}return this.combinedHistory=i,this.combinedHistory}}const y=(t,e,i,a,s=!0,n=!0,o)=>{const r={type:"history/stream",entity_ids:a,start_time:new Date((new Date).getTime()-3600*i*1e3).toISOString(),minimal_response:s,significant_changes_only:n,no_attributes:o??!a.some((e=>c(t,e)))},d=new m(t,i);return t.connection.subscribeMessage((t=>e(d.processMessage(t))),r)},p=(t,e)=>t.state===e.state&&(!t.attributes||!e.attributes||h.every((i=>t.attributes[i]===e.attributes[i]))),f=(t,e,i,a,s,r,d)=>{const l=[],h=r[0];for(const o of r){if(l.length>0&&o.s===l[l.length-1].state)continue;const r={};d?.attributes.device_class&&(r.device_class=d?.attributes.device_class),l.push({state_localize:(0,n.J)(t,e,[],i,a[s],s,{...o.a||h.a,...r},o.s),state:o.s,last_changed:1e3*(o.lc?o.lc:o.lu)})}return{name:(0,o._)(s,d?.attributes||h.a),entity_id:s,data:l}},k=(t,e,i,a)=>{const n=[];return Object.keys(i).forEach((t=>{const e=i[t],r=e[0],l=(0,s.m)(t),c=[];for(const t of e){let e;if(d.includes(l)){e={state:t.s,last_changed:1e3*t.lu,attributes:{}};for(const i of h)i in t.a&&(e.attributes[i]=t.a[i])}else e={state:t.s,last_changed:1e3*(t.lc?t.lc:t.lu),attributes:{}};c.length>1&&p(e,c[c.length-1])&&p(e,c[c.length-2])||c.push(e)}const u=t in a?a[t].attributes:"friendly_name"in r.a?r.a:void 0;n.push({domain:l,name:(0,o._)(t,u||{}),entity_id:t,states:c})})),{unit:t,device_class:e,identifier:Object.keys(i).join(""),data:n}},g=["counter","input_number","number"],_=t=>g.includes(t),v=t=>"unit_of_measurement"in t||"state_class"in t,b=(t,e)=>null!=t.attributes.device_class&&e.includes(t.attributes.device_class),x=" ",w=(t,e,i,a,n,o=!1,r=!1)=>{const d={},l=[],h={};if(new Set([...i,...Object.keys(e)]).forEach((i=>{i in e?h[i]=e[i]:t.states[i]&&(h[i]=[{s:t.states[i].state,a:t.states[i].attributes,lu:new Date(t.states[i].last_updated).getTime()/1e3}])})),!h)return{line:[],timeline:[]};Object.keys(h).forEach((e=>{const i=h[e];if(0===i.length)return;const c=(0,s.m)(e),u=e in t.states?t.states[e]:void 0,m=u||_(c)?void 0:i.find((t=>t.a&&v(t.a)));let y;y=r||_(c)||null!=u&&v(u.attributes)||null!=u&&"sensor"===c&&b(u,n)||null!=m?u?.attributes.unit_of_measurement||m?.a.unit_of_measurement||x:{zone:a("ui.dialogs.more_info_control.zone.graph_unit"),climate:t.config.unit_system.temperature,humidifier:"%",water_heater:t.config.unit_system.temperature}[c];const p=$(y,{climate:"temperature",humidifier:"humidity",water_heater:"temperature"}[c]||(u?.attributes||m?.a)?.device_class,o);y?p&&p in d&&e in d[p]?d[p][e].push(...i):p&&(p in d||(d[p]={}),d[p][e]=i):l.push(f(a,t.locale,t.config,t.entities,e,i,u))}));return{line:Object.keys(d).map((e=>{const i=e.split("_"),a=i[0],s=i[1]||void 0;return k(a,s,d[e],t.states)})),timeline:l}},$=(t,e,i)=>i?`${t}_${e||""}`:t;a()}catch(t){a(t)}}))},28884:(t,e,i)=>{i.d(e,{i:()=>a});const a=async()=>{await i.e(1138).then(i.bind(i,1138))}}};
//# sourceMappingURL=81140.4s4FsEvAOco.js.map