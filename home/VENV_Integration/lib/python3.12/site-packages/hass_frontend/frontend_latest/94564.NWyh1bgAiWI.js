export const id=94564;export const ids=[94564];export const modules={95589:(e,t,i)=>{i.a(e,(async(e,t)=>{try{var s=i(36312),a=i(15112),l=i(77706),n=i(58558),o=i(57289),d=i(34897),r=i(45269),h=(i(88400),i(90431),e([o]));o=(h.then?(await h)():h)[0];const u="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z",c=()=>Promise.all([i.e(10963),i.e(59089),i.e(89059),i.e(25984),i.e(20232)]).then(i.bind(i,20232)),m=(e,t)=>{(0,d.r)(e,"show-dialog",{dialogTag:"ha-dialog-date-picker",dialogImport:c,dialogParams:t})};(0,s.A)([(0,l.EM)("ha-date-input")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,l.MZ)({attribute:!1})],key:"locale",value:void 0},{kind:"field",decorators:[(0,l.MZ)()],key:"value",value:void 0},{kind:"field",decorators:[(0,l.MZ)()],key:"min",value:void 0},{kind:"field",decorators:[(0,l.MZ)()],key:"max",value:void 0},{kind:"field",decorators:[(0,l.MZ)({type:Boolean})],key:"disabled",value:()=>!1},{kind:"field",decorators:[(0,l.MZ)({type:Boolean})],key:"required",value:()=>!1},{kind:"field",decorators:[(0,l.MZ)()],key:"label",value:void 0},{kind:"field",decorators:[(0,l.MZ)()],key:"helper",value:void 0},{kind:"field",decorators:[(0,l.MZ)({type:Boolean})],key:"canClear",value:()=>!1},{kind:"method",key:"render",value:function(){return a.qy`<ha-textfield .label="${this.label}" .helper="${this.helper}" .disabled="${this.disabled}" iconTrailing helperPersistent readonly="readonly" @click="${this._openDialog}" @keydown="${this._keyDown}" .value="${this.value?(0,o.zB)(new Date(`${this.value.split("T")[0]}T00:00:00`),{...this.locale,time_zone:r.Wj.local},{}):""}" .required="${this.required}"> <ha-svg-icon slot="trailingIcon" .path="${u}"></ha-svg-icon> </ha-textfield>`}},{kind:"method",key:"_openDialog",value:function(){this.disabled||m(this,{min:this.min||"1970-01-01",max:this.max,value:this.value,canClear:this.canClear,onChange:e=>this._valueChanged(e),locale:this.locale.language,firstWeekday:(0,n.PE)(this.locale)})}},{kind:"method",key:"_keyDown",value:function(e){this.canClear&&["Backspace","Delete"].includes(e.key)&&this._valueChanged(void 0)}},{kind:"method",key:"_valueChanged",value:function(e){this.value!==e&&(this.value=e,(0,d.r)(this,"change"),(0,d.r)(this,"value-changed",{value:e}))}},{kind:"get",static:!0,key:"styles",value:function(){return a.AH`ha-svg-icon{color:var(--secondary-text-color)}ha-textfield{display:block}`}}]}}),a.WF);t()}catch(e){t(e)}}))},6431:(e,t,i)=>{i.a(e,(async(e,s)=>{try{i.r(t),i.d(t,{HaDateTimeSelector:()=>h});var a=i(36312),l=i(15112),n=i(77706),o=i(34897),d=i(95589),r=(i(3316),i(31511),e([d]));d=(r.then?(await r)():r)[0];let h=(0,a.A)([(0,n.EM)("ha-selector-datetime")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"selector",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"value",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"label",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"helper",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,reflect:!0})],key:"disabled",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"required",value:()=>!0},{kind:"field",decorators:[(0,n.P)("ha-date-input")],key:"_dateInput",value:void 0},{kind:"field",decorators:[(0,n.P)("ha-time-input")],key:"_timeInput",value:void 0},{kind:"method",key:"render",value:function(){const e="string"==typeof this.value?this.value.split(" "):void 0;return l.qy` <div class="input"> <ha-date-input .label="${this.label}" .locale="${this.hass.locale}" .disabled="${this.disabled}" .required="${this.required}" .value="${e?.[0]}" @value-changed="${this._valueChanged}"> </ha-date-input> <ha-time-input enable-second .value="${e?.[1]||"00:00:00"}" .locale="${this.hass.locale}" .disabled="${this.disabled}" .required="${this.required}" @value-changed="${this._valueChanged}"></ha-time-input> </div> ${this.helper?l.qy`<ha-input-helper-text>${this.helper}</ha-input-helper-text>`:""} `}},{kind:"method",key:"_valueChanged",value:function(e){e.stopPropagation(),this._dateInput.value&&this._timeInput.value&&(0,o.r)(this,"value-changed",{value:`${this._dateInput.value} ${this._timeInput.value}`})}},{kind:"field",static:!0,key:"styles",value:()=>l.AH`.input{display:flex;align-items:center;flex-direction:row}ha-date-input{min-width:150px;margin-right:4px;margin-inline-end:4px;margin-inline-start:initial}`}]}}),l.WF);s()}catch(e){s(e)}}))},98667:(e,t,i)=>{i.r(t),i.d(t,{HaNumberSelector:()=>d});var s=i(36312),a=i(15112),l=i(77706),n=i(85323),o=i(34897);i(31511),i(97249),i(90431);let d=(0,s.A)([(0,l.EM)("ha-selector-number")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,l.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,l.MZ)({attribute:!1})],key:"selector",value:void 0},{kind:"field",decorators:[(0,l.MZ)({type:Number})],key:"value",value:void 0},{kind:"field",decorators:[(0,l.MZ)({type:Number})],key:"placeholder",value:void 0},{kind:"field",decorators:[(0,l.MZ)()],key:"label",value:void 0},{kind:"field",decorators:[(0,l.MZ)()],key:"helper",value:void 0},{kind:"field",decorators:[(0,l.MZ)({type:Boolean})],key:"required",value:()=>!0},{kind:"field",decorators:[(0,l.MZ)({type:Boolean})],key:"disabled",value:()=>!1},{kind:"field",key:"_valueStr",value:()=>""},{kind:"method",key:"willUpdate",value:function(e){e.has("value")&&(""!==this._valueStr&&this.value===Number(this._valueStr)||(this._valueStr=null==this.value||isNaN(this.value)?"":this.value.toString()))}},{kind:"method",key:"render",value:function(){const e="box"===this.selector.number?.mode||void 0===this.selector.number?.min||void 0===this.selector.number?.max;let t;if(!e&&(t=this.selector.number.step??1,"any"===t)){t=1;const e=(this.selector.number.max-this.selector.number.min)/100;for(;t>e;)t/=10}return a.qy` ${this.label&&!e?a.qy`${this.label}${this.required?"*":""}`:a.s6} <div class="input"> ${e?a.s6:a.qy` <ha-slider labeled .min="${this.selector.number.min}" .max="${this.selector.number.max}" .value="${this.value??""}" .step="${t}" .disabled="${this.disabled}" .required="${this.required}" @change="${this._handleSliderChange}" .ticks="${this.selector.number?.slider_ticks}"> </ha-slider> `} <ha-textfield .inputMode="${"any"===this.selector.number?.step||(this.selector.number?.step??1)%1!=0?"decimal":"numeric"}" .label="${e?this.label:void 0}" .placeholder="${this.placeholder}" class="${(0,n.H)({single:e})}" .min="${this.selector.number?.min}" .max="${this.selector.number?.max}" .value="${this._valueStr??""}" .step="${this.selector.number?.step??1}" helperPersistent .helper="${e?this.helper:void 0}" .disabled="${this.disabled}" .required="${this.required}" .suffix="${this.selector.number?.unit_of_measurement}" type="number" autoValidate ?no-spinner="${!e}" @input="${this._handleInputChange}"> </ha-textfield> </div> ${!e&&this.helper?a.qy`<ha-input-helper-text>${this.helper}</ha-input-helper-text>`:a.s6} `}},{kind:"method",key:"_handleInputChange",value:function(e){e.stopPropagation(),this._valueStr=e.target.value;const t=""===e.target.value||isNaN(e.target.value)?void 0:Number(e.target.value);this.value!==t&&(0,o.r)(this,"value-changed",{value:t})}},{kind:"method",key:"_handleSliderChange",value:function(e){e.stopPropagation();const t=Number(e.target.value);this.value!==t&&(0,o.r)(this,"value-changed",{value:t})}},{kind:"get",static:!0,key:"styles",value:function(){return a.AH`.input{display:flex;justify-content:space-between;align-items:center;direction:ltr}ha-slider{flex:1;margin-right:16px;margin-inline-end:16px;margin-inline-start:0}ha-textfield{--ha-textfield-input-width:40px}.single{--ha-textfield-input-width:unset;flex:1}`}}]}}),a.WF)},94564:(e,t,i)=>{i.a(e,(async(e,s)=>{try{i.r(t),i.d(t,{DialogStatisticsFixUnsupportedUnitMetadata:()=>k});var a=i(36312),l=(i(89655),i(253),i(54846),i(72606),i(14526)),n=i(15112),o=i(77706),d=i(94100),r=i(8581),h=i(34897),u=(i(37629),i(3276),i(36185),i(46163),i(13830),i(6431)),c=(i(98667),i(88400),i(4826)),m=i(6121),v=i(55321),p=i(18589),_=e([r,u]);[r,u]=_.then?(await _)():_;let k=(0,a.A)([(0,o.EM)("dialog-statistics-adjust-sum")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_params",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_busy",value:()=>!1},{kind:"field",decorators:[(0,o.wk)()],key:"_moment",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_stats5min",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_statsHour",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_chosenStat",value:void 0},{kind:"field",key:"_origAmount",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_amount",value:void 0},{kind:"field",key:"_dateTimeSelector",value:()=>({datetime:{}})},{kind:"field",key:"_amountSelector",value:()=>(0,d.A)((e=>({number:{step:.01,unit_of_measurement:e,mode:"box"}})))},{kind:"method",key:"showDialog",value:function(e){this._params=e;const t=new Date;t.setMinutes(t.getMinutes()-t.getMinutes()%5,0),this._moment=(0,l.s)(t),this._fetchStats()}},{kind:"method",key:"closeDialog",value:function(){this._params=void 0,this._moment=void 0,this._stats5min=void 0,this._statsHour=void 0,this._origAmount=void 0,this._amount=void 0,this._chosenStat=void 0,this._busy=!1,(0,h.r)(this,"dialog-closed",{dialog:this.localName})}},{kind:"method",key:"render",value:function(){if(!this._params)return n.s6;let e;return e=this._chosenStat?this._renderAdjustStat():this._renderPickStatistic(),n.qy` <ha-dialog open scrimClickAction escapeKeyAction @closed="${this.closeDialog}" .heading="${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.title")}"> ${e} </ha-dialog> `}},{kind:"method",key:"shouldUpdate",value:function(e){if(1!==e.size||!e.has("hass"))return!0;const t=e.get("hass");return!t||t.localize!==this.hass.localize}},{kind:"method",key:"_renderPickStatistic",value:function(){let e;if(this._stats5min&&this._statsHour)if(this._statsHour.length<1&&this._stats5min.length<1)e=n.qy`<p> ${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.no_statistics_found")} </p>`;else{const t=this._stats5min.length>=1?this._stats5min:this._statsHour,i=(0,c.JE)(this.hass,this._params.statistic.statistic_id,this._params.statistic),s=[];for(let e=0;e<t.length;e++){const a=t[e],l=Math.round(100*a.change)/100;s.push(n.qy` <ha-list-item twoline hasMeta .stat="${a}" @click="${this._setChosenStatistic}"> <span>${l} ${i}</span> <span slot="secondary"> ${(0,r.r6)(new Date(a.start),this.hass.locale,this.hass.config)} </span> <ha-icon-next slot="meta"></ha-icon-next> </ha-list-item> `)}e=n.qy`${s}`}else e=n.qy`<ha-circular-progress indeterminate></ha-circular-progress>`;return n.qy` <div class="text-content"> ${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.info_text_1")} </div> <div class="text-content"> <b>${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.statistic")}</b> ${this._params.statistic.statistic_id} </div> <ha-selector-datetime .label="${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.pick_a_time")}" .hass="${this.hass}" .selector="${this._dateTimeSelector}" .value="${this._moment}" @value-changed="${this._dateTimeSelectorChanged}"></ha-selector-datetime> <div class="stat-list">${e}</div> <mwc-button slot="secondaryAction" .label="${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.outliers")}" @click="${this._fetchOutliers}"></mwc-button> <mwc-button slot="primaryAction" dialogAction="cancel" .label="${this.hass.localize("ui.common.close")}"></mwc-button> `}},{kind:"method",key:"_clearChosenStatistic",value:function(){this._chosenStat=void 0}},{kind:"method",key:"_setChosenStatistic",value:function(e){const t=e.currentTarget.stat,i=Math.round(100*t.change)/100;this._chosenStat=t,this._origAmount=i,this._amount=i}},{kind:"method",key:"_dateTimeSelectorChanged",value:function(e){this._moment=e.detail.value,this._fetchStats()}},{kind:"method",key:"_renderAdjustStat",value:function(){const e=(0,c.JE)(this.hass,this._params.statistic.statistic_id,this._params.statistic);return n.qy` <div class="text-content"> <b>${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.statistic")}</b> ${this._params.statistic.statistic_id} </div> <div class="table-row"> <span>${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.start")}</span> <span>${(0,r.r6)(new Date(this._chosenStat.start),this.hass.locale,this.hass.config)}</span> </div> <div class="table-row"> <span>${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.end")}</span> <span>${(0,r.r6)(new Date(this._chosenStat.end),this.hass.locale,this.hass.config)}</span> </div> <ha-selector-number .label="${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.new_value")}" .hass="${this.hass}" .selector="${this._amountSelector(e||void 0)}" .value="${this._amount}" .disabled="${this._busy}" @value-changed="${this._amountChanged}"></ha-selector-number> <mwc-button slot="primaryAction" .label="${this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.adjust")}" .disabled="${this._busy}" @click="${this._fixIssue}"></mwc-button> <mwc-button slot="secondaryAction" .label="${this.hass.localize("ui.common.back")}" .disabled="${this._busy}" @click="${this._clearChosenStatistic}"></mwc-button> `}},{kind:"method",key:"_amountChanged",value:function(e){this._amount=e.detail.value}},{kind:"method",key:"_fetchStats",value:async function(){this._stats5min=void 0,this._statsHour=void 0;const e=this._params.statistic.statistic_id,t=new Date(this._moment.replace(" ","T")),i=new Date(t.getTime());i.setTime(i.getTime()-72e5);const s=new Date(t.getTime());s.setTime(s.getTime()+108e5);const a=await(0,c.sz)(this.hass,i,s,[e],"hour");if(this._statsHour=e in a?a[e].slice(0,5):[],0===this._statsHour.length)return void(this._stats5min=[]);const l=new Date(t.getTime());l.setTime(l.getTime()-6e5);const n=new Date(t.getTime());n.setTime(n.getTime()+9e5);const o=await(0,c.sz)(this.hass,l,n,[e],"5minute");this._stats5min=e in o?o[e].slice(0,5):[]}},{kind:"method",key:"_fetchOutliers",value:async function(){this._stats5min=void 0,this._statsHour=void 0;const e=this._params.statistic.statistic_id,t=new Date(0),i=new Date,s=await(0,c.sz)(this.hass,t,i,[e],"hour"),a=e in s?s[e]:[];if(0===a.length)return;const l=await(0,c.sz)(this.hass,t,i,[e],"5minute"),n=e in l?l[e]:[];n.shift();const o=[];a.forEach((e=>{o.push({hour:e,fiveMin:[]})}));const d={hour:null,fiveMin:[]};let r=0;n.forEach((e=>{let t=!1;for(;r<o.length;r++){const i=o[r].hour;if(i&&e.start>=i.start&&e.end<=i.end){o[r].fiveMin.push(e),t=!0;break}}t||d.fiveMin.push(e)})),o.push(d);let h=[],u=0;const m=e=>{const t=Math.abs(e.change??0);(h.length<10||t>u)&&(h.push(e),h=h.sort(((e,t)=>Math.abs(t.change??0)-Math.abs(e.change??0))),h=h.slice(0,10),u=h[h.length-1].change??0)};o.forEach((e=>{0===e.fiveMin.length&&e.hour?m(e.hour):e.fiveMin.forEach((e=>{m(e)}))})),this._statsHour=h,this._stats5min=[]}},{kind:"method",key:"_fixIssue",value:async function(){const e=(0,c.JE)(this.hass,this._params.statistic.statistic_id,this._params.statistic);this._busy=!0;try{await(0,c.Uf)(this.hass,this._params.statistic.statistic_id,this._chosenStat.start,this._amount-this._origAmount,e||null)}catch(e){return this._busy=!1,void(0,m.showAlertDialog)(this,{text:this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.error_sum_adjusted",{message:e.message||e})})}(0,p.P)(this,{message:this.hass.localize("ui.panel.developer-tools.tabs.statistics.fix_issue.adjust_sum.sum_adjusted")}),this.closeDialog()}},{kind:"get",static:!0,key:"styles",value:function(){return[v.RF,v.nA,n.AH`@media all and (max-width:450px),all and (max-height:500px){ha-dialog{--mdc-dialog-max-height:100%;height:100%}}@media all and (min-width:850px){ha-dialog{--mdc-dialog-max-height:80%;--mdc-dialog-max-height:80%}}@media all and (min-width:451px) and (min-height:501px){ha-dialog{--mdc-dialog-max-width:480px}}.text-content,ha-selector-datetime,ha-selector-number{margin-bottom:20px}ha-list-item{margin:0 -24px;--mdc-list-side-padding:24px}.table-row{display:flex;justify-content:space-between;margin-bottom:20px}.stat-list{min-height:360px;display:flex;flex-direction:column}.stat-list ha-circular-progress{margin:0 auto}`]}}]}}),n.WF);s()}catch(e){s(e)}}))},14306:(e,t,i)=>{function s(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}i.d(t,{F:()=>s})},14526:(e,t,i)=>{i.d(t,{s:()=>n});var s=i(14306),a=i(26862),l=i(21710);function n(e,t){const i=(0,l.a)(e,t?.in);if(!(0,a.f)(i))throw new RangeError("Invalid time value");const n=t?.format??"extended",o=t?.representation??"complete";let d="";const r="extended"===n?"-":"",h="extended"===n?":":"";if("time"!==o){const e=(0,s.F)(i.getDate(),2),t=(0,s.F)(i.getMonth()+1,2);d=`${(0,s.F)(i.getFullYear(),4)}${r}${t}${r}${e}`}if("date"!==o){d=`${d}${""===d?"":" "}${(0,s.F)(i.getHours(),2)}${h}${(0,s.F)(i.getMinutes(),2)}${h}${(0,s.F)(i.getSeconds(),2)}`}return d}},26862:(e,t,i)=>{function s(e){return e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}i.d(t,{f:()=>l});var a=i(21710);function l(e){return!(!s(e)&&"number"!=typeof e||isNaN(+(0,a.a)(e)))}}};
//# sourceMappingURL=94564.NWyh1bgAiWI.js.map